<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico">
  <link rel="mask-icon" href="/images/favicon.ico" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"right","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="✔ 完成填写订单模块的开发。 ✔ 完成订单详情模块的开发。 ✔ 完成订单列表模块的开发。">
<meta property="og:type" content="article">
<meta property="og:title" content="06_小兔鲜">
<meta property="og:url" content="http://example.com/2023/05/06/xcx-xtx-06/index.html">
<meta property="og:site_name" content="危险">
<meta property="og:description" content="✔ 完成填写订单模块的开发。 ✔ 完成订单详情模块的开发。 ✔ 完成订单列表模块的开发。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/resource/images/cart_picture_1.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-09_13-02-23.png">
<meta property="og:image" content="http://example.com/resource/images/cart_picture_2.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-09_14-15-57.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-09_14-35-46.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-09_14-44-30.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-09_14-47-41.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-09_14-54-24.png">
<meta property="og:image" content="http://example.com/resource/images/cart_picture_3.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-09_16-12-59.png">
<meta property="og:image" content="http://example.com/resource/images/order_picture_1.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-09_16-52-53.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-09_17-04-41.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-09_17-58-04.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_08-45-43.png">
<meta property="og:image" content="http://example.com/resource/images/order_picture_2.gif">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_09-07-02.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_09-23-02.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_10-16-50.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_10-41-32.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_11-24-34.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_11-28-26.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_11-36-04.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_15-33-25.png">
<meta property="og:image" content="http://example.com/resource/images/order_picture_3.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_15-49-53.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_15-55-43.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_16-09-57.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_16-23-54.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_16-38-46.png">
<meta property="og:image" content="http://example.com/resource/images/build_picture_2.png">
<meta property="og:image" content="http://example.com/resource/images/Snipaste_2023-05-10_16-49-58.png">
<meta property="article:published_time" content="2023-05-06T00:48:24.000Z">
<meta property="article:modified_time" content="2023-05-11T07:42:51.712Z">
<meta property="article:author" content="Ifer">
<meta property="article:tag" content="React,Redux,Mobx,Saga,Dva,Umi,AntD,TS">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/resource/images/cart_picture_1.png">

<link rel="canonical" href="http://example.com/2023/05/06/xcx-xtx-06/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>06_小兔鲜 | 危险</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">危险</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">为之则易，不为则难</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://example.com/2023/05/06/xcx-xtx-06/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/49337922.png">
      <meta itemprop="name" content="Ifer">
      <meta itemprop="description" content="React 全家桶 <span style='position:relative;top:-2px;'>✍</span>">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="危险">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          06_小兔鲜
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2023-05-06 08:48:24" itemprop="dateCreated datePublished" datetime="2023-05-06T08:48:24+08:00">2023-05-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2023-05-11 15:42:51" itemprop="dateModified" datetime="2023-05-11T15:42:51+08:00">2023-05-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <p>✔ 完成填写订单模块的开发。</p>
<p>✔ 完成订单详情模块的开发。</p>
<p>✔ 完成订单列表模块的开发。</p>
<span id="more"></span>

<h2 id="加入购物车"><a href="#加入购物车" class="headerlink" title="加入购物车"></a>加入购物车</h2><p>在商品详情页把 <strong>选中规格后的商品(SKU)</strong> 加入购物车。</p>
<p><img src="/resource/images/cart_picture_1.png" alt="购物车"></p>
<h3 id="接口封装"><a href="#接口封装" class="headerlink" title="接口封装"></a>接口封装</h3><p><code>src/services/cart.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 加入购物车</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>data 请求体参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> postMemberCartAPI = <span class="function">(<span class="params">data: &#123; skuId: <span class="built_in">string</span>; count: <span class="built_in">number</span> &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/cart&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="参考代码"><a href="#参考代码" class="headerlink" title="参考代码"></a>参考代码</h3><p>通过 <code>SKU</code> 组件提供的 <code>add-cart</code> 事件，获取加入购物车时所需的参数，<code>pages/goods/goods.vue</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; postMemberCartAPI &#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/cart&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> type &#123; SkuPopupEvent &#125; <span class="keyword">from</span> <span class="string">&#x27;@/components/vk-data-goods-sku-popup/vk-data-goods-sku-popup&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="comment">// 加入购物车事件</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onAddCart = <span class="keyword">async</span> (ev: SkuPopupEvent) =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">await</span> postMemberCartAPI(&#123; <span class="attr">skuId</span>: ev._id, <span class="attr">count</span>: ev.buy_num &#125;)</span></span><br><span class="line"><span class="javascript">  uni.showToast(&#123; <span class="attr">title</span>: <span class="string">&#x27;添加成功&#x27;</span> &#125;)</span></span><br><span class="line"><span class="javascript">  isShowSku.value = <span class="literal">false</span></span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- SKU弹窗组件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">vk-data-goods-sku-popup</span> <span class="attr">v-model</span>=<span class="string">&quot;isShowSku&quot;</span> <span class="attr">:localdata</span>=<span class="string">&quot;localdata&quot;</span> @<span class="attr">add-cart</span>=<span class="string">&quot;onAddCart&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下"><a href="#小结一下" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-09_13-02-23.png"/>

<h2 id="购物车列表"><a href="#购物车列表" class="headerlink" title="购物车列表"></a>购物车列表</h2><p>购物车列表需要访问后才能登录。</p>
<p><img src="/resource/images/cart_picture_2.png" alt="购物车"></p>
<h3 id="静态结构"><a href="#静态结构" class="headerlink" title="静态结构"></a>静态结构</h3><p><code>src/pages/cart/cart.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">//</span></span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">scroll-y</span> <span class="attr">class</span>=<span class="string">&quot;scroll-view&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 已登录: 显示购物车 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 购物车列表 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cart-list&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 优惠提示 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tips&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;label&quot;</span>&gt;</span>满减<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;desc&quot;</span>&gt;</span>满1件, 即可享受9折优惠<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 滑动操作分区 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">uni-swipe-action</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 滑动操作项 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">uni-swipe-action-item</span> <span class="attr">v-for</span>=<span class="string">&quot;item in 2&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item&quot;</span> <span class="attr">class</span>=<span class="string">&quot;cart-swipe&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 商品信息 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;goods&quot;</span>&gt;</span></span><br><span class="line">              <span class="comment">&lt;!-- 选中状态 --&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; checked: true &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:url</span>=<span class="string">&quot;`/pages/goods/goods?id=1435025`&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">class</span>=<span class="string">&quot;navigator&quot;</span></span></span><br><span class="line"><span class="tag">              &gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">image</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">mode</span>=<span class="string">&quot;aspectFill&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;picture&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">src</span>=<span class="string">&quot;https://yanxuan-item.nosdn.127.net/da7143e0103304f0f3230715003181ee.jpg&quot;</span></span></span><br><span class="line"><span class="tag">                &gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;meta&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;name ellipsis&quot;</span>&gt;</span>人手必备，儿童轻薄透气防蚊裤73-140cm<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;attrsText ellipsis&quot;</span>&gt;</span>黄色小象 140cm<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;price&quot;</span>&gt;</span>69.00<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">              <span class="comment">&lt;!-- 商品数量 --&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;count&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">input</span> <span class="attr">class</span>=<span class="string">&quot;input&quot;</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 右侧删除按钮 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">template</span> #<span class="attr">right</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cart-swipe-right&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;button delete-button&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">uni-swipe-action-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">uni-swipe-action</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 购物车空状态 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cart-blank&quot;</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;/static/images/blank_cart.png&quot;</span> <span class="attr">class</span>=<span class="string">&quot;image&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>购物车还是空的，快来挑选好货吧<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;/pages/index/index&quot;</span> <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span>去首页看看<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 吸底工具栏 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;toolbar&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;all&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; checked: true &#125;&quot;</span>&gt;</span>全选<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>合计:<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;amount&quot;</span>&gt;</span>100<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button-grounp&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button payment-button&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; disabled: true &#125;&quot;</span>&gt;</span> 去结算(10) <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 未登录: 提示登录 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;login-blank&quot;</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>登录后可查看购物车中的商品<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;/pages/login/login&quot;</span> <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span>去登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 猜你喜欢 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">XtxGuess</span> <span class="attr">ref</span>=<span class="string">&quot;guessRef&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">XtxGuess</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 底部占位空盒子 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;toolbar-height&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">// 根元素</span></span><br><span class="line"><span class="css"><span class="selector-pseudo">:host</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="css">  <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#f7f7f8</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">// 滚动容器</span></span><br><span class="line"><span class="css"><span class="selector-class">.scroll-view</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">// 购物车列表</span></span><br><span class="line"><span class="css"><span class="selector-class">.cart-list</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  // 优惠提示</span></span><br><span class="line"><span class="css">  <span class="selector-class">.tips</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">line-height</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin</span>: <span class="number">30</span>rpx <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#666</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.label</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding</span>: <span class="number">7</span>rpx <span class="number">15</span>rpx <span class="number">5</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">4</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">background-color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-right</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  // 购物车商品</span></span><br><span class="line"><span class="css">  <span class="selector-class">.goods</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">20</span>rpx <span class="number">20</span>rpx <span class="number">20</span>rpx <span class="number">80</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">border-radius</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.navigator</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.checkbox</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">      <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">width</span>: <span class="number">80</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      &amp;<span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">content</span>: <span class="string">&#x27;\e6cd&#x27;</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">font-family</span>: <span class="string">&#x27;erabbit&#x27;</span> <span class="meta">!important</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">font-size</span>: <span class="number">40</span>rpx;</span></span><br><span class="line"><span class="css">        <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      &amp;<span class="selector-class">.checked</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">content</span>: <span class="string">&#x27;\e6cc&#x27;</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.picture</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">width</span>: <span class="number">170</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">170</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.meta</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="css">      <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-left</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.name</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">72</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.attrsText</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">line-height</span>: <span class="number">1.8</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">15</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-self</span>: flex-start;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">4</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#888</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">background-color</span>: <span class="number">#f7f7f8</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.price</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">line-height</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-bottom</span>: <span class="number">2</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#cf4444</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      &amp;<span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">content</span>: <span class="string">&#x27;￥&#x27;</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">font-size</span>: <span class="number">80%</span>;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    // 商品数量</span></span><br><span class="line"><span class="css">    <span class="selector-class">.count</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">      <span class="attribute">bottom</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">right</span>: <span class="number">5</span>rpx;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">width</span>: <span class="number">220</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">48</span>rpx;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="selector-class">.text</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">        <span class="attribute">font-size</span>: <span class="number">32</span>rpx;</span></span><br><span class="line"><span class="css">        <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="selector-class">.input</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">        <span class="attribute">border-radius</span>: <span class="number">4</span>rpx;</span></span><br><span class="line"><span class="css">        <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="css">        <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">background-color</span>: <span class="number">#f6f6f6</span>;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.cart-swipe</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin</span>: <span class="number">20</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.cart-swipe-right</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.button</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">width</span>: <span class="number">50px</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding</span>: <span class="number">6px</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">line-height</span>: <span class="number">1.5</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.delete-button</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">background-color</span>: <span class="number">#cf4444</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">// 空状态</span></span><br><span class="line"><span class="css"><span class="selector-class">.cart-blank</span>,</span></span><br><span class="line"><span class="css"><span class="selector-class">.login-blank</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">  <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">  <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">60vh</span>;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.image</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">400</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">281</span>rpx;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.text</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin</span>: <span class="number">20</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.button</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">240</span>rpx <span class="meta">!important</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">60</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">line-height</span>: <span class="number">60</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-top</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">border-radius</span>: <span class="number">60</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">// 吸底工具栏</span></span><br><span class="line"><span class="css"><span class="selector-class">.toolbar</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="css">  <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">bottom</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--window-bottom));</span></span><br><span class="line"><span class="css">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">100</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-top</span>: <span class="number">1</span>rpx solid <span class="number">#ededed</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-bottom</span>: <span class="number">1</span>rpx solid <span class="number">#ededed</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.all</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-left</span>: <span class="number">25</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.all</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-family</span>: <span class="string">&#x27;erabbit&#x27;</span> <span class="meta">!important</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">content</span>: <span class="string">&#x27;\e6cd&#x27;</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">40</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-right</span>: <span class="number">8</span>rpx;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.checked</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">content</span>: <span class="string">&#x27;\e6cc&#x27;</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.text</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-right</span>: <span class="number">8</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-left</span>: <span class="number">32</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.amount</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">20px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#cf4444</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.decimal</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    &amp;<span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">content</span>: <span class="string">&#x27;￥&#x27;</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.button-grounp</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">    <span class="attribute">right</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">top</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">line-height</span>: <span class="number">72</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">13px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>);</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.button</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">width</span>: <span class="number">240</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">72</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.payment-button</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">background-color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      &amp;<span class="selector-class">.disabled</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">opacity</span>: <span class="number">0.6</span>;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css">// 底部占位空盒子</span></span><br><span class="line"><span class="css"><span class="selector-class">.toolbar-height</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">100</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">box-sizing</span>: content-box;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="登录状态"><a href="#登录状态" class="headerlink" title="登录状态"></a>登录状态</h3><p>已登录显示购物车列表，否则应引导用户去登录。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; useMemberStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores&#x27;</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取会员Store</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> memberStore = useMemberStore()</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">scroll-y</span> <span class="attr">class</span>=<span class="string">&quot;scroll-view&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 已登录: 显示购物车 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;memberStore.profile&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 购物车列表 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 未登录: 提示登录 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;login-blank&quot;</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>登录后可查看购物车中的商品<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;/pages/login/login&quot;</span> <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span>去登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>pages/login/login.vue</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 登录成功后直接返回</span></span><br><span class="line"><span class="keyword">const</span> loginSuccess = <span class="function">(<span class="params">profile: LoginResult</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 保存会员信息</span></span><br><span class="line">  <span class="keyword">const</span> memberStore = useMemberStore()</span><br><span class="line">  memberStore.setProfile(profile)</span><br><span class="line">  <span class="comment">// 成功提示</span></span><br><span class="line">  uni.showToast(&#123; <span class="attr">icon</span>: <span class="string">&#x27;success&#x27;</span>, <span class="attr">title</span>: <span class="string">&#x27;登录成功&#x27;</span> &#125;)</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 页面跳转</span></span><br><span class="line">    <span class="comment">// uni.switchTab(&#123; url: &#x27;/pages/my/my&#x27; &#125;)</span></span><br><span class="line">    uni.navigateBack()</span><br><span class="line">  &#125;, <span class="number">500</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h3><p>调用接口获取当前登录用户购物车中的商品列表。</p>
<p><code>src/services/cart.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取购物车列表</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getMemberCartAPI = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;CartItem[]&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/cart&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<p><code>src/types/cart.d.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 购物车类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> CartItem = &#123;</span><br><span class="line">  <span class="comment">/** 商品 ID */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** SKU ID */</span></span><br><span class="line">  <span class="attr">skuId</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 图片 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 数量 */</span></span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 加入时价格 */</span></span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 当前的价格 */</span></span><br><span class="line">  <span class="attr">nowPrice</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 库存 */</span></span><br><span class="line">  <span class="attr">stock</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 是否选中 */</span></span><br><span class="line">  <span class="attr">selected</span>: <span class="built_in">boolean</span></span><br><span class="line">  <span class="comment">/** 属性文字 */</span></span><br><span class="line">  <span class="attr">attrsText</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 是否为有效商品 */</span></span><br><span class="line">  <span class="attr">isEffective</span>: <span class="built_in">boolean</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong></p>
<p>在页面初始化的时候判断用户是否已登录，已登录获取购物车列表。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; getMemberCartAPI &#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/cart&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; useMemberStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> type &#123; CartItem &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/cart&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; onShow &#125; <span class="keyword">from</span> <span class="string">&#x27;@dcloudio/uni-app&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取会员Store</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> memberStore = useMemberStore()</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取购物车数据</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> cartList = ref&lt;CartItem[]&gt;([])</span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> getMemberCartData = <span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> res = <span class="keyword">await</span> getMemberCartAPI()</span></span><br><span class="line"><span class="javascript">  cartList.value = res.result</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 初始化调用: 页面显示触发</span></span></span><br><span class="line"><span class="javascript">onShow(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 用户已登录才允许调用</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (memberStore.profile) &#123;</span></span><br><span class="line"><span class="javascript">    getMemberCartData()</span></span><br><span class="line"><span class="javascript">  &#125;</span></span><br><span class="line"><span class="javascript">&#125;)</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;memberStore.profile&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 购物车列表 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- #1 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cart-list&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;cartList.length&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 优惠提示 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tips&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;label&quot;</span>&gt;</span>满减<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;desc&quot;</span>&gt;</span>满1件, 即可享受9折优惠<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 滑动操作分区 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">uni-swipe-action</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 滑动操作项 --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- #2 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">uni-swipe-action-item</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-for</span>=<span class="string">&quot;item in cartList&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:key</span>=<span class="string">&quot;item.skuId&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;cart-swipe&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 商品信息 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;goods&quot;</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 选中状态 --&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- #3 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; checked: item.selected &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- #4 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:url</span>=<span class="string">&quot;`/pages/goods/goods?id=$&#123;item.id&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;navigator&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- #5 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">image</span></span></span><br><span class="line"><span class="tag">              <span class="attr">mode</span>=<span class="string">&quot;aspectFill&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;picture&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:src</span>=<span class="string">&quot;item.picture&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;meta&quot;</span>&gt;</span></span><br><span class="line">              <span class="comment">&lt;!-- #6 --&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;name ellipsis&quot;</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;attrsText ellipsis&quot;</span>&gt;</span>&#123;&#123; item.attrsText &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;price&quot;</span>&gt;</span>&#123;&#123; item.nowPrice &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 商品数量 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;count&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>-<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- #7 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;input&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;number&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:value</span>=<span class="string">&quot;item.count.toString()&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>+<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 右侧删除按钮 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> #<span class="attr">right</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cart-swipe-right&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;button delete-button&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">uni-swipe-action-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">uni-swipe-action</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 购物车空状态 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cart-blank&quot;</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">src</span>=<span class="string">&quot;/static/images/blank_cart.png&quot;</span> <span class="attr">class</span>=<span class="string">&quot;image&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>购物车还是空的，快来挑选好货吧<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;/pages/index/index&quot;</span> <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span>去首页看看<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 吸底工具栏 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;toolbar&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;all&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; checked: true &#125;&quot;</span>&gt;</span>全选<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>合计:<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;amount&quot;</span>&gt;</span>100<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button-grounp&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button payment-button&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; disabled: true &#125;&quot;</span>&gt;</span></span><br><span class="line">        去结算(10)</span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-1"><a href="#小结一下-1" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-09_14-15-57.png"/>

<h2 id="删除购物车"><a href="#删除购物车" class="headerlink" title="删除购物车"></a>删除购物车</h2><p>通过侧滑删除购物车的商品，使用 <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/component/uniui/uni-swipe-action.html">uni-swipe-action</a> 组件实现。</p>
<h3 id="接口封装-1"><a href="#接口封装-1" class="headerlink" title="接口封装"></a>接口封装</h3><p><code>src/services/cart.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除/清空购物车单品</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>data 请求体参数 ids SKUID 集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> deleteMemberCartAPI = <span class="function">(<span class="params">data: &#123; ids: <span class="built_in">string</span>[] &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;DELETE&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/cart&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="参考代码-1"><a href="#参考代码-1" class="headerlink" title="参考代码"></a>参考代码</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; deleteMemberCartAPI &#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/cart&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="comment">// 点击删除按钮</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onDeleteCart = <span class="function">(<span class="params">skuId: string</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 弹窗二次确认</span></span></span><br><span class="line"><span class="javascript">  uni.showModal(&#123;</span></span><br><span class="line"><span class="javascript">    <span class="attr">content</span>: <span class="string">&#x27;是否删除&#x27;</span>,</span></span><br><span class="line"><span class="javascript">    <span class="attr">success</span>: <span class="keyword">async</span> (res) =&gt; &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span> (res.confirm) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 后端删除单品</span></span></span><br><span class="line"><span class="javascript">        <span class="keyword">await</span> deleteMemberCartAPI(&#123; <span class="attr">ids</span>: [skuId] &#125;)</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 重新获取列表</span></span></span><br><span class="line"><span class="javascript">        getMemberCartData()</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">  &#125;)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 右侧删除按钮 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> #<span class="attr">right</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cart-swipe-right&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> @<span class="attr">tap</span>=<span class="string">&quot;onDeleteCart(item.skuId)&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button delete-button&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-2"><a href="#小结一下-2" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-09_14-35-46.png"/>

<h2 id="修改商品信息"><a href="#修改商品信息" class="headerlink" title="修改商品信息"></a>修改商品信息</h2><p>修改购买数量，修改选中状态。</p>
<h3 id="接口封装-2"><a href="#接口封装-2" class="headerlink" title="接口封装"></a>接口封装</h3><p><code>src/services/cart.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 修改购物车单品</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>skuId SKUID</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>data selected 选中状态 count 商品数量</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> putMemberCartBySkuIdAPI = <span class="function">(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="function">  skuId: <span class="built_in">string</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">  data: &#123; selected?: <span class="built_in">boolean</span>; count?: <span class="built_in">number</span> &#125;,</span></span></span><br><span class="line"><span class="params"><span class="function"></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;PUT&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/cart/<span class="subst">$&#123;skuId&#125;</span>`</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="修改商品数量"><a href="#修改商品数量" class="headerlink" title="修改商品数量"></a>修改商品数量</h3><p>复用 <code>SKU</code> 插件中的 <strong>步进器组件</strong> 修改商品数量，补充<strong>类型声明文件</strong>让组件类型更安全。</p>
<p><code>src/components/vk-data-input-number-box/vk-data-input-number-box.d.ts</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">&#x27;@uni-helper/uni-app-types&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 步进器 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> InputNumberBox = Component&lt;InputNumberBoxProps&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 步进器实例 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> InputNumberBoxInstance = InstanceType&lt;InputNumberBox&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 步进器属性 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> InputNumberBoxProps = &#123;</span><br><span class="line">  <span class="comment">/** 输入框初始值（默认1） */</span></span><br><span class="line">  <span class="attr">modelValue</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 用户可输入的最小值（默认0） */</span></span><br><span class="line">  <span class="attr">min</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 用户可输入的最大值（默认99999） */</span></span><br><span class="line">  <span class="attr">max</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/**  步长，每次加或减的值（默认1） */</span></span><br><span class="line">  <span class="attr">step</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 是否禁用操作，包括输入框，加减按钮 */</span></span><br><span class="line">  <span class="attr">disabled</span>: <span class="built_in">boolean</span></span><br><span class="line">  <span class="comment">/** 输入框宽度，单位rpx（默认80） */</span></span><br><span class="line">  <span class="attr">inputWidth</span>: <span class="built_in">string</span> | <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/**  输入框和按钮的高度，单位rpx（默认50） */</span></span><br><span class="line">  <span class="attr">inputHeight</span>: <span class="built_in">string</span> | <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 输入框和按钮的背景颜色（默认#F2F3F5） */</span></span><br><span class="line">  <span class="attr">bgColor</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 步进器标识符 */</span></span><br><span class="line">  <span class="attr">index</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 输入框内容发生变化时触发 */</span></span><br><span class="line">  <span class="attr">onChange</span>: <span class="function">(<span class="params">event: InputNumberBoxEvent</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">  <span class="comment">/** 输入框失去焦点时触发 */</span></span><br><span class="line">  <span class="attr">onBlur</span>: <span class="function">(<span class="params">event: InputNumberBoxEvent</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">  <span class="comment">/** 点击增加按钮时触发 */</span></span><br><span class="line">  <span class="attr">onPlus</span>: <span class="function">(<span class="params">event: InputNumberBoxEvent</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">  <span class="comment">/** 点击减少按钮时触发 */</span></span><br><span class="line">  <span class="attr">onMinus</span>: <span class="function">(<span class="params">event: InputNumberBoxEvent</span>) =&gt;</span> <span class="built_in">void</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 步进器事件对象 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> InputNumberBoxEvent = &#123;</span><br><span class="line">  <span class="comment">/** 输入框当前值 */</span></span><br><span class="line">  <span class="attr">value</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 步进器标识符 */</span></span><br><span class="line">  <span class="attr">index</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 全局组件类型声明 */</span></span><br><span class="line"><span class="keyword">declare</span> <span class="built_in">module</span> <span class="string">&#x27;@vue/runtime-core&#x27;</span> &#123;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">interface</span> GlobalComponents &#123;</span><br><span class="line">    <span class="string">&#x27;vk-data-input-number-box&#x27;</span>: InputNumberBox</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="参考代码-2"><a href="#参考代码-2" class="headerlink" title="参考代码"></a>参考代码</h3><p><code>pages/cart/cart.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> type &#123; InputNumberBoxEvent &#125; <span class="keyword">from</span> <span class="string">&#x27;@/components/vk-data-input-number-box/vk-data-input-number-box&#x27;</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 修改商品数量</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onChangeCount = <span class="function">(<span class="params">ev: InputNumberBoxEvent</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  putMemberCartBySkuIdAPI(ev.index, &#123; <span class="attr">count</span>: ev.value &#125;)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 商品数量 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;count&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">vk-data-input-number-box</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-model</span>=<span class="string">&quot;item.count&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:min</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:max</span>=<span class="string">&quot;item.stock&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:index</span>=<span class="string">&quot;item.skuId&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">change</span>=<span class="string">&quot;onChangeCount&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-3"><a href="#小结一下-3" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-09_14-44-30.png"/>

<h3 id="修改商品选中-全选"><a href="#修改商品选中-全选" class="headerlink" title="修改商品选中/全选"></a>修改商品选中/全选</h3><p>封装全选的函数，<code>src/services/cart.ts</code>。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 购物车全选/取消全选</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>data selected 是否选中</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> putMemberCartSelectedAPI = <span class="function">(<span class="params">data: &#123; selected: <span class="built_in">boolean</span> &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;PUT&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/cart/selected&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="参考代码-3"><a href="#参考代码-3" class="headerlink" title="参考代码"></a>参考代码</h3><p><code>pages/cart/cart.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 修改选中状态-单品修改</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onChangeSelected = <span class="function">(<span class="params">item: CartItem</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 前端数据更新-是否选中取反</span></span></span><br><span class="line"><span class="javascript">  item.selected = !item.selected</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 后端数据更新</span></span></span><br><span class="line"><span class="javascript">  putMemberCartBySkuIdAPI(item.skuId, &#123; <span class="attr">selected</span>: item.selected &#125;)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 计算全选状态</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> isSelectedAll = computed(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">return</span> cartList.value.length &amp;&amp; cartList.value.every(<span class="function">(<span class="params">v</span>) =&gt;</span> v.selected)</span></span><br><span class="line"><span class="javascript">&#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 修改选中状态-全选修改</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onChangeSelectedAll = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 全选状态取反</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> _isSelectedAll = !isSelectedAll.value</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 前端数据更新</span></span></span><br><span class="line"><span class="javascript">  cartList.value.forEach(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">    item.selected = _isSelectedAll</span></span><br><span class="line"><span class="javascript">  &#125;)</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 后端数据更新</span></span></span><br><span class="line"><span class="javascript">  putMemberCartSelectedAPI(&#123; <span class="attr">selected</span>: _isSelectedAll &#125;)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 商品信息 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;goods&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 选中状态 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> @<span class="attr">tap</span>=<span class="string">&quot;onChangeSelected(item)&quot;</span> <span class="attr">class</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; checked: item.selected &#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 吸底工具栏 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;toolbar&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> @<span class="attr">tap</span>=<span class="string">&quot;onChangeSelectedAll&quot;</span> <span class="attr">class</span>=<span class="string">&quot;all&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; checked: isSelectedAll &#125;&quot;</span>&gt;</span>全选<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-4"><a href="#小结一下-4" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-09_14-47-41.png"/>

<h2 id="底部结算信息"><a href="#底部结算信息" class="headerlink" title="底部结算信息"></a>底部结算信息</h2><h3 id="计算总钱数-总金额"><a href="#计算总钱数-总金额" class="headerlink" title="计算总钱数(总金额)"></a>计算总钱数(总金额)</h3><p>计算并展示购物车中选中商品所要支付的总金额，在用户切换商品选中状态和改变购数量后总的金额也要相应的进行重新计算，要实现这个功能我们仍然借助计算属性来实现。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 计算选中单品列表</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> selectedCartList = computed(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">return</span> cartList.value.filter(<span class="function">(<span class="params">v</span>) =&gt;</span> v.selected)</span></span><br><span class="line"><span class="javascript">&#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 计算选中总件数</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> selectedCartListCount = computed(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">return</span> selectedCartList.value.reduce(<span class="function">(<span class="params">sum, item</span>) =&gt;</span> sum + item.count, <span class="number">0</span>)</span></span><br><span class="line"><span class="javascript">&#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 计算选中总金额</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> selectedCartListMoney = computed(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">return</span> selectedCartList.value</span></span><br><span class="line"><span class="javascript">    .reduce(<span class="function">(<span class="params">sum, item</span>) =&gt;</span> sum + item.count * item.nowPrice, <span class="number">0</span>)</span></span><br><span class="line"><span class="javascript">    .toFixed(<span class="number">2</span>)</span></span><br><span class="line"><span class="javascript">&#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 结算按钮</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> gotoPayment = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (selectedCartListCount.value === <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> uni.showToast(&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">title</span>: <span class="string">&#x27;请选择商品&#x27;</span>,</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript">  &#125;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 跳转到结算页</span></span></span><br><span class="line"><span class="javascript">  uni.navigateTo(&#123; <span class="attr">url</span>: <span class="string">&#x27;/pagesOrder/create/create&#x27;</span> &#125;)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>合计:<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;amount&quot;</span>&gt;</span>&#123;&#123; selectedCartListMoney &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button-grounp&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">tap</span>=<span class="string">&quot;gotoPayment&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;button payment-button&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:class</span>=<span class="string">&quot;&#123; disabled: selectedCartListCount === 0 &#125;&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    去结算(&#123;&#123; selectedCartListCount &#125;&#125;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-5"><a href="#小结一下-5" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-09_14-54-24.png"/>

<h2 id="带返回按钮的购物车"><a href="#带返回按钮的购物车" class="headerlink" title="带返回按钮的购物车"></a>带返回按钮的购物车</h2><p>为了解决小程序 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/api/route/wx.switchTab.html">tabBar 页面限制</a> 导致无法返回上一页的问题，将购物车业务独立为组件，使其既可从底部 tabBar 访问，又可在商品详情页中<strong>跳转并返回</strong>。</p>
<p>这样就需要 <strong>两个购物车页面</strong> 实现该功能，其中一个页面为 tabBar 页，另一个为普通页。</p>
<p><img src="/resource/images/cart_picture_3.png" alt="购物车页"></p>
<p>目录结构如下。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">pages/cart</span><br><span class="line">├── components</span><br><span class="line">│   └── CartMain.vue ...................................... 购物车业务组件</span><br><span class="line">├── cart2.vue ............................................. 普通页</span><br><span class="line">└── cart.vue   ............................................ TabBar页</span><br></pre></td></tr></table></figure>

<p><code>pages/cart/cart.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span> <span class="attr">setup</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> CartMain <span class="keyword">from</span> <span class="string">&#x27;./components/CartMain.vue&#x27;</span></span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">CartMain</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>pages.json</code> 多添加一项配置。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;pages&quot;</span>: [</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;path&quot;</span>: <span class="string">&quot;pages/cart/cart&quot;</span>,</span><br><span class="line">      <span class="string">&quot;style&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;navigationBarTitleText&quot;</span>: <span class="string">&quot;购物车&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;path&quot;</span>: <span class="string">&quot;pages/cart/cart2&quot;</span>,</span><br><span class="line">      <span class="string">&quot;style&quot;</span>: &#123;</span><br><span class="line">        <span class="string">&quot;navigationBarTitleText&quot;</span>: <span class="string">&quot;购物车&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>pages/goods/goods.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;icons-button&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">url</span>=<span class="string">&quot;/pages/cart/cart2&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">open-type</span>=<span class="string">&quot;navigate&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;icon-cart&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span>购物车</span><br><span class="line"><span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>把原本的购物车业务独立封装成组件，在两个购物车页面分别引入即可。</p>
<p><strong>tabBar 页</strong>：小程序跳转到 tabBar 页面时，会关闭其他所有非 tabBar 页面，所以小程序的 tabBar 页没有后退按钮。</p>
<img src="/resource/images/Snipaste_2023-05-09_16-12-59.png"/>

<h2 id="填写订单页"><a href="#填写订单页" class="headerlink" title="填写订单页"></a>填写订单页</h2><p>小兔鲜儿项目有三种方式可以生成订单信息，分别是：购物车结算、立即购买、再次购买。</p>
<p><img src="/resource/images/order_picture_1.png" alt="填写订单"></p>
<h3 id="静态结构-1"><a href="#静态结构-1" class="headerlink" title="静态结构"></a>静态结构</h3><p>分包，<code>src/pagesOrder/create/create.vue</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; computed, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取屏幕边界到安全区域距离</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span></span><br><span class="line"><span class="javascript"><span class="comment">// 订单备注</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> buyerMessage = ref(<span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line"><span class="javascript"><span class="comment">// 配送时间</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> deliveryList = ref([</span></span><br><span class="line"><span class="javascript">  &#123; <span class="attr">type</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">&#x27;时间不限 (周一至周日)&#x27;</span> &#125;,</span></span><br><span class="line"><span class="javascript">  &#123; <span class="attr">type</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">&#x27;工作日送 (周一至周五)&#x27;</span> &#125;,</span></span><br><span class="line"><span class="javascript">  &#123; <span class="attr">type</span>: <span class="number">3</span>, <span class="attr">text</span>: <span class="string">&#x27;周末配送 (周六至周日)&#x27;</span> &#125;,</span></span><br><span class="line"><span class="javascript">])</span></span><br><span class="line"><span class="javascript"><span class="comment">// 当前配送时间下标</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> activeIndex = ref(<span class="number">0</span>)</span></span><br><span class="line"><span class="javascript"><span class="comment">// 当前配送时间</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> activeDelivery = computed(<span class="function">() =&gt;</span> deliveryList.value[activeIndex.value])</span></span><br><span class="line"><span class="javascript"><span class="comment">// 修改配送时间</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onChangeDelivery: UniHelper.SelectorPickerOnChange = <span class="function">(<span class="params">ev</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  activeIndex.value = ev.detail.value</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">scroll-y</span> <span class="attr">class</span>=<span class="string">&quot;viewport&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 收货地址 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-if</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;shipment&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">url</span>=<span class="string">&quot;/pagesMember/address/address?from=order&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;user&quot;</span>&gt;</span> 张三 13333333333 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;address&quot;</span>&gt;</span> 广东省 广州市 天河区 黑马程序员3 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;icon icon-right&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-else</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;shipment&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">url</span>=<span class="string">&quot;/pagesMember/address/address?from=order&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;address&quot;</span>&gt;</span> 请选择收货地址 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;icon icon-right&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 商品信息 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;goods&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-for</span>=<span class="string">&quot;item in 2&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:key</span>=<span class="string">&quot;item&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:url</span>=<span class="string">&quot;`/pages/goods/goods?id=1`&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;item&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">image</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;picture&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">src</span>=<span class="string">&quot;https://yanxuan-item.nosdn.127.net/c07edde1047fa1bd0b795bed136c2bb2.jpg&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;meta&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;name ellipsis&quot;</span>&gt;</span> ins风小碎花泡泡袖衬110-160cm <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;attrs&quot;</span>&gt;</span>藏青小花 130<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;prices&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;pay-price symbol&quot;</span>&gt;</span>99.00<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;price symbol&quot;</span>&gt;</span>99.00<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;count&quot;</span>&gt;</span>x5<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 配送及支付方式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;related&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>配送时间<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">picker</span> <span class="attr">:range</span>=<span class="string">&quot;deliveryList&quot;</span> <span class="attr">range-key</span>=<span class="string">&quot;text&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;onChangeDelivery&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;icon-fonts picker&quot;</span>&gt;</span>&#123;&#123; activeDelivery.text &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">picker</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>订单备注<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;input&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:cursor-spacing</span>=<span class="string">&quot;30&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">placeholder</span>=<span class="string">&quot;选题，建议留言前先与商家沟通确认&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-model</span>=<span class="string">&quot;buyerMessage&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 支付金额 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;settlement&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>商品总价: <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;number symbol&quot;</span>&gt;</span>495.00<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>运费: <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;number symbol&quot;</span>&gt;</span>5.00<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 吸底工具栏 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;toolbar&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;total-pay symbol&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;number&quot;</span>&gt;</span>99.00<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; disabled: true &#125;&quot;</span>&gt;</span> 提交订单 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">page &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#f4f4f4</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.symbol</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">content</span>: <span class="string">&#x27;¥&#x27;</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">font-size</span>: <span class="number">80%</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">margin-right</span>: <span class="number">5</span>rpx;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.shipment</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">margin</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">30</span>rpx <span class="number">30</span>rpx <span class="number">30</span>rpx <span class="number">84</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-radius</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">background</span>: <span class="built_in">url</span>(<span class="string">https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/locate.png</span>)</span></span><br><span class="line"><span class="css">    <span class="number">20</span>rpx center / <span class="number">50</span>rpx no-repeat <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.icon</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">36</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>);</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">    <span class="attribute">top</span>: <span class="number">50%</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">right</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.user</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-bottom</span>: <span class="number">5</span>rpx;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.address</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#666</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.goods</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">margin</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-radius</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.item</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">30</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">border-top</span>: <span class="number">1</span>rpx solid <span class="number">#eee</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    &amp;<span class="selector-pseudo">:first</span>-child &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-top</span>: none;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.picture</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">width</span>: <span class="number">170</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">170</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-right</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.meta</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="css">      <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.name</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">80</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.attrs</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">line-height</span>: <span class="number">1.8</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">15</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-top</span>: <span class="number">6</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-self</span>: flex-start;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">4</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#888</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">background-color</span>: <span class="number">#f7f7f8</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.prices</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-items</span>: baseline;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-top</span>: <span class="number">6</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="selector-class">.pay-price</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">margin-right</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">        <span class="attribute">color</span>: <span class="number">#cf4444</span>;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="selector-class">.price</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="css">        <span class="attribute">color</span>: <span class="number">#999</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">text-decoration</span>: line-through;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.count</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">      <span class="attribute">bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.related</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">margin</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-radius</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.item</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">min-height</span>: <span class="number">80</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.input</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-align</span>: right;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin</span>: <span class="number">20</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding-right</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#999</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.item</span> <span class="selector-class">.text</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">125</span>rpx;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.picker</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#666</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.picker</span><span class="selector-pseudo">::after</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">content</span>: <span class="string">&#x27;\e6c2&#x27;</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="comment">/* 结算清单 */</span></span></span><br><span class="line"><span class="css"><span class="selector-class">.settlement</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">margin</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-radius</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.item</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">80</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.danger</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#cf4444</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="comment">/* 吸底工具栏 */</span></span></span><br><span class="line"><span class="css"><span class="selector-class">.toolbar</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="css">  <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">bottom</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--window-bottom));</span></span><br><span class="line"><span class="css">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">100</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-top</span>: <span class="number">1</span>rpx solid <span class="number">#eaeaea</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="css">  <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">  <span class="attribute">box-sizing</span>: content-box;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.total-pay</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">40</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#cf4444</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.decimal</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">75%</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.button</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">220</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">line-height</span>: <span class="number">72</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">border-radius</span>: <span class="number">72</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.disabled</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">opacity</span>: <span class="number">0.6</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="渲染基本信息"><a href="#渲染基本信息" class="headerlink" title="渲染基本信息"></a>渲染基本信息</h3><p>在购物车点击去结算后，进入填写订单页，用户可以选择订单的收货地址或补充订单信息。</p>
<p><code>src/services/order.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; OrderPreResult &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/order&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 填写订单-获取预付订单</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getMemberOrderPreAPI = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;OrderPreResult&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/order/pre&#x27;</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>类型声明</strong></p>
<p><code>src/types/order.d.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; AddressItem &#125; <span class="keyword">from</span> <span class="string">&#x27;./address&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/** 获取预付订单 返回信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> OrderPreResult = &#123;</span><br><span class="line">  <span class="comment">/** 商品集合 [ 商品信息 ] */</span></span><br><span class="line">  <span class="attr">goods</span>: OrderPreGoods[]</span><br><span class="line">  <span class="comment">/** 结算信息 */</span></span><br><span class="line">  <span class="attr">summary</span>: &#123;</span><br><span class="line">    <span class="comment">/** 商品总价 */</span></span><br><span class="line">    <span class="attr">totalPrice</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="comment">/** 邮费 */</span></span><br><span class="line">    <span class="attr">postFee</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="comment">/** 应付金额 */</span></span><br><span class="line">    <span class="attr">totalPayPrice</span>: <span class="built_in">number</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/** 用户地址列表 [ 地址信息 ] */</span></span><br><span class="line">  <span class="attr">userAddresses</span>: AddressItem[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 商品信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> OrderPreGoods = &#123;</span><br><span class="line">  <span class="comment">/** 属性文字，例如“颜色:瓷白色 尺寸：8寸” */</span></span><br><span class="line">  <span class="attr">attrsText</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 数量 */</span></span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 实付单价 */</span></span><br><span class="line">  <span class="attr">payPrice</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 图片 */</span></span><br><span class="line">  <span class="attr">picture</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 原单价 */</span></span><br><span class="line">  <span class="attr">price</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** SKUID */</span></span><br><span class="line">  <span class="attr">skuId</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 实付价格小计 */</span></span><br><span class="line">  <span class="attr">totalPayPrice</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 小计总价 */</span></span><br><span class="line">  <span class="attr">totalPrice</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将后端返回的预付订单数据，渲染到页面中。</p>
<p>页面中调用，<code>src/pagesOrder/create/create.vue</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; getMemberOrderPreAPI &#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/order&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; OrderPreResult &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/order&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; onLoad &#125; <span class="keyword">from</span> <span class="string">&#x27;@dcloudio/uni-app&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> orderPre = ref&lt;OrderPreResult&gt;()</span><br><span class="line"><span class="keyword">const</span> getMemberOrderPreData = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> getMemberOrderPreAPI()</span><br><span class="line">  orderPre.value = res.result</span><br><span class="line">&#125;</span><br><span class="line">onLoad(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  getMemberOrderPreData()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="渲染内容"><a href="#渲染内容" class="headerlink" title="渲染内容"></a>渲染内容</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;goods&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-for</span>=<span class="string">&quot;item in orderPre?.goods&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:key</span>=<span class="string">&quot;item.skuId&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:url</span>=<span class="string">&quot;`/pages/goods/goods?id=$&#123;item.id&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;item&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;picture&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;item.picture&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;meta&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;name ellipsis&quot;</span>&gt;</span> &#123;&#123; item.name &#125;&#125; <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;attrs&quot;</span>&gt;</span>&#123;&#123; item.attrsText &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;prices&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;pay-price symbol&quot;</span>&gt;</span>&#123;&#123; item.payPrice &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;price symbol&quot;</span>&gt;</span>&#123;&#123; item.price &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;count&quot;</span>&gt;</span>x&#123;&#123; item.count &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;settlement&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>商品总价: <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;number symbol&quot;</span>&gt;</span>&#123;&#123;</span><br><span class="line">      orderPre?.summary.totalPayPrice.toFixed(2)</span><br><span class="line">    &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>运费: <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;number symbol&quot;</span>&gt;</span>&#123;&#123;</span><br><span class="line">      orderPre?.summary.postFee.toFixed(2)</span><br><span class="line">    &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;toolbar&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;total-pay symbol&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;number&quot;</span>&gt;</span>&#123;&#123;</span><br><span class="line">      orderPre?.summary.totalPayPrice.toFixed(2)</span><br><span class="line">    &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; disabled: true &#125;&quot;</span>&gt;</span> 提交订单 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-6"><a href="#小结一下-6" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-09_16-52-53.png"/>

<h2 id="渲染收获地址"><a href="#渲染收获地址" class="headerlink" title="渲染收获地址"></a>渲染收获地址</h2><ol>
<li>渲染默认收获地址，<code>src/pagesOrder/create/create.vue</code>。</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> selecteAddress = computed(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> orderPre.value?.userAddresses.find(<span class="function">(<span class="params">v</span>) =&gt;</span> v.isDefault)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-if</span>=<span class="string">&quot;selecteAddress&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;shipment&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">url</span>=<span class="string">&quot;/pagesMember/address/address?from=order&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">    &#123;&#123; selecteAddress?.receiver &#125;&#125; &#123;&#123; selecteAddress?.contact &#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;address&quot;</span>&gt;</span></span><br><span class="line">    &#123;&#123; selecteAddress?.fullLocation &#125;&#125; &#123;&#123; selecteAddress?.address &#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;icon icon-right&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>为了更好管理选中收货地址，创建独立 Store 维护，<code>stores/modules/address.ts</code>。</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; AddressItem &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/address&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; defineStore &#125; <span class="keyword">from</span> <span class="string">&#x27;pinia&#x27;</span></span><br><span class="line"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> useAddressStore = defineStore(<span class="string">&#x27;address&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> selectedAddress = ref&lt;AddressItem&gt;()</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> changeSelectedAddress = <span class="function">(<span class="params">val: AddressItem</span>) =&gt;</span> &#123;</span><br><span class="line">    selectedAddress.value = val</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123; selectedAddress, changeSelectedAddress &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<p><code>src/pagesOrder/create/create.vue</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> addressStore = useAddressStore()</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> selecteAddress = computed(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    addressStore.selectedAddress ||</span><br><span class="line">    orderPre.value?.userAddresses.find(<span class="function">(<span class="params">v</span>) =&gt;</span> v.isDefault)</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h3 id="地址管理页"><a href="#地址管理页" class="headerlink" title="地址管理页"></a>地址管理页</h3><p>修改选中收货地址，<code>&lt;navigator&gt;</code> 组件需要阻止事件冒泡，<code>pagesMember/address/address.vue</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 修改收货地址</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onChangeAddress = <span class="function">(<span class="params">item: AddressItem</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 修改选中收货地址</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> addressStore = useAddressStore()</span></span><br><span class="line"><span class="javascript">  addressStore.changeSelectedAddress(item)</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 返回上一页</span></span></span><br><span class="line"><span class="javascript">  uni.navigateBack()</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 收货地址项 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">uni-swipe-action-item</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">v-for</span>=<span class="string">&quot;item in addressList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item-content&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;onChangeAddress(item)&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">        &#123;&#123; item.receiver &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;contact&quot;</span>&gt;</span>&#123;&#123; item.contact &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">v-if</span>=<span class="string">&quot;item.isDefault&quot;</span> <span class="attr">class</span>=<span class="string">&quot;badge&quot;</span>&gt;</span>默认<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;locate&quot;</span>&gt;</span>&#123;&#123; item.fullLocation &#125;&#125; &#123;&#123; item.address &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 记得这儿阻止冒泡 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;edit&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:url</span>=<span class="string">&quot;`/pagesMember/address-form/address-form?id=$&#123;item.id&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">        @<span class="attr">tap.stop</span>=<span class="string">&quot;() =&gt; &#123;&#125;&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        修改</span><br><span class="line">      <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">uni-swipe-action-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-7"><a href="#小结一下-7" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-09_17-04-41.png"/>

<h2 id="立即购买"><a href="#立即购买" class="headerlink" title="立即购买"></a>立即购买</h2><p>从商品详情页的 <code>SKU</code> 组件直接点击【立即购买按钮】跳转到填写订单页，需要传递页面参数。</p>
<h3 id="封装接口"><a href="#封装接口" class="headerlink" title="封装接口"></a>封装接口</h3><p><code>src/services/order.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 填写订单-获取立即购买订单</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getMemberOrderPreNowAPI = <span class="function">(<span class="params">data: &#123;</span></span></span><br><span class="line"><span class="params"><span class="function">  skuId: <span class="built_in">string</span></span></span></span><br><span class="line"><span class="params"><span class="function">  count: <span class="built_in">string</span></span></span></span><br><span class="line"><span class="params"><span class="function">  addressId?: <span class="built_in">string</span></span></span></span><br><span class="line"><span class="params"><span class="function">&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;OrderPreResult&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/order/pre/now&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="页面传参"><a href="#页面传参" class="headerlink" title="页面传参"></a>页面传参</h3><p>从商品详情页的【立即购买事件】中收集两个必要参数，跳转填写订单页并<strong>传递页面参数</strong>。</p>
<p><code>pages/goods/goods.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 立即购买</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onBuyNow = <span class="function">(<span class="params">ev: SkuPopupEvent</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  uni.navigateTo(&#123; <span class="attr">url</span>: <span class="string">`/pagesOrder/create/create?skuId=<span class="subst">$&#123;ev._id&#125;</span>&amp;count=<span class="subst">$&#123;ev.buy_num&#125;</span>`</span> &#125;)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- SKU 弹窗组件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">vk-data-goods-sku-popup</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-model</span>=<span class="string">&quot;isShowSku&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:localdata</span>=<span class="string">&quot;localdata&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:mode</span>=<span class="string">&quot;mode&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">add-cart-background-color</span>=<span class="string">&quot;#FFA868&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">buy-now-background-color</span>=<span class="string">&quot;#27BA9B&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">ref</span>=<span class="string">&quot;skuPopupRef&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:actived-style</span>=<span class="string">&quot;&#123;</span></span></span><br><span class="line"><span class="string"><span class="tag">      color: &#x27;#27BA9B&#x27;,</span></span></span><br><span class="line"><span class="string"><span class="tag">      borderColor: &#x27;#27BA9B&#x27;,</span></span></span><br><span class="line"><span class="string"><span class="tag">      backgroundColor: &#x27;#E9F8F5&#x27;</span></span></span><br><span class="line"><span class="string"><span class="tag">    &#125;&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">add-cart</span>=<span class="string">&quot;onAddCart&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">buy-now</span>=<span class="string">&quot;onBuyNow&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="填写订单"><a href="#填写订单" class="headerlink" title="填写订单"></a>填写订单</h3><p><code>pagesOrder/create/create.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; getMemberOrderPreAPI, getMemberOrderPreNowAPI &#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/order&#x27;</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// #0 接收参数</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> query = defineProps&lt;&#123;</span></span><br><span class="line"><span class="javascript">  skuId?: string</span></span><br><span class="line"><span class="javascript">  count?: string</span></span><br><span class="line"><span class="javascript">&#125;&gt;()</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> orderPre = ref&lt;OrderPreResult&gt;()</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> getMemberOrderPreData = <span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// #2</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (query.count &amp;&amp; query.skuId) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 调用立即购买 API</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> res = <span class="keyword">await</span> getMemberOrderPreNowAPI(&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">count</span>: query.count,</span></span><br><span class="line"><span class="javascript">      <span class="attr">skuId</span>: query.skuId</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript">    orderPre.value = res.result</span></span><br><span class="line"><span class="javascript">  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 调用预支付 API</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> res = <span class="keyword">await</span> getMemberOrderPreAPI()</span></span><br><span class="line"><span class="javascript">    orderPre.value = res.result</span></span><br><span class="line"><span class="javascript">  &#125;</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-8"><a href="#小结一下-8" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-09_17-58-04.png"/>

<h2 id="提交订单"><a href="#提交订单" class="headerlink" title="提交订单"></a>提交订单</h2><p>收集填写订单页的数据，点击页面底部的提交订单按钮，创建一个新的订单。</p>
<h3 id="类型声明"><a href="#类型声明" class="headerlink" title="类型声明"></a>类型声明</h3><p><code>src/types/order.d.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 提交订单 请求参数 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> OrderCreateParams = &#123;</span><br><span class="line">  <span class="comment">/** 所选地址Id */</span></span><br><span class="line">  <span class="attr">addressId</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 配送时间类型，1为不限，2为工作日，3为双休或假日 */</span></span><br><span class="line">  <span class="attr">deliveryTimeType</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 订单备注 */</span></span><br><span class="line">  <span class="attr">buyerMessage</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品集合[ 商品信息 ] */</span></span><br><span class="line">  <span class="attr">goods</span>: &#123;</span><br><span class="line">    <span class="comment">/** 数量 */</span></span><br><span class="line">    <span class="attr">count</span>: <span class="built_in">number</span></span><br><span class="line">    <span class="comment">/** skuId */</span></span><br><span class="line">    <span class="attr">skuId</span>: <span class="built_in">string</span></span><br><span class="line">  &#125;[]</span><br><span class="line">  <span class="comment">/** 支付渠道：支付渠道，1支付宝、2微信--支付方式为在线支付时，传值，为货到付款时，不传值 */</span></span><br><span class="line">  <span class="attr">payChannel</span>: <span class="number">1</span> | <span class="number">2</span></span><br><span class="line">  <span class="comment">/** 支付方式，1为在线支付，2为货到付款 */</span></span><br><span class="line">  <span class="attr">payType</span>: <span class="number">1</span> | <span class="number">2</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 提交订单 返回信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> OrderCreateResult = &#123;</span><br><span class="line">  <span class="comment">/** 订单Id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="接口封装-3"><a href="#接口封装-3" class="headerlink" title="接口封装"></a>接口封装</h3><p><code>src/services/order.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 提交订单</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>data 请求参数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> postMemberOrderAPI = <span class="function">(<span class="params">data: OrderCreateParams</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;&#123; <span class="attr">id</span>: <span class="built_in">string</span> &#125;&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/member/order&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="参考代码-4"><a href="#参考代码-4" class="headerlink" title="参考代码"></a>参考代码</h3><p>点击提交订单按钮实现创建订单，订单创建成功后，跳转到订单详情并传递订单 id。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// ...</span></span></span><br><span class="line"><span class="javascript"><span class="comment">// 提交订单</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onOrderSubmit = <span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (!selecteAddress.value?.id) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> uni.showToast(&#123; <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span>, <span class="attr">title</span>: <span class="string">&#x27;请选择收货地址&#x27;</span> &#125;)</span></span><br><span class="line"><span class="javascript">  &#125;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> res = <span class="keyword">await</span> postMemberOrderAPI(&#123;</span></span><br><span class="line"><span class="javascript">    <span class="attr">addressId</span>: selecteAddress.value.id, <span class="comment">// 地址 ID</span></span></span><br><span class="line"><span class="javascript">    <span class="attr">buyerMessage</span>: buyerMessage.value, <span class="comment">// 买家留言</span></span></span><br><span class="line"><span class="javascript">    <span class="attr">deliveryTimeType</span>: activeDelivery.value.type, <span class="comment">// 配送时间类型，1 为不限，2 为工作日，3 为双休或假日</span></span></span><br><span class="line"><span class="javascript">    <span class="attr">goods</span>: orderPre.value!.goods.map(<span class="function">(<span class="params">v</span>) =&gt;</span> (&#123;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// 商品集合</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">count</span>: v.count,</span></span><br><span class="line"><span class="javascript">      <span class="attr">skuId</span>: v.skuId</span></span><br><span class="line"><span class="javascript">    &#125;)),</span></span><br><span class="line"><span class="javascript">    <span class="attr">payChannel</span>: <span class="number">2</span>, <span class="comment">// 支付渠道，1 表示支付宝，2 表示微信</span></span></span><br><span class="line"><span class="javascript">    <span class="attr">payType</span>: <span class="number">1</span> <span class="comment">// 支付方式，1 为在线支付，2 为货到付款</span></span></span><br><span class="line"><span class="javascript">  &#125;)</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 关闭当前页面，跳转到订单详情，传递订单id</span></span></span><br><span class="line"><span class="javascript">  uni.redirectTo(&#123; <span class="attr">url</span>: <span class="string">`/pagesOrder/detail/detail?id=<span class="subst">$&#123;res.result.id&#125;</span>`</span> &#125;)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; disabled: !selecteAddress?.id &#125;&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;onOrderSubmit&quot;</span>&gt;</span></span><br><span class="line">    提交订单</span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-9"><a href="#小结一下-9" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-10_08-45-43.png"/>

<h2 id="订单详情页"><a href="#订单详情页" class="headerlink" title="订单详情页"></a>订单详情页</h2><p>需要展示<strong>多种订单状态</strong> 并实现不同订单状态对应的业务。</p>
<h3 id="静态结构-2"><a href="#静态结构-2" class="headerlink" title="静态结构"></a>静态结构</h3><p>已完成通过页面参数获取到订单 id 等基础业务，<code>pagesOrder/detail/detail.vue</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; useGuessList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/composables&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取屏幕边界到安全区域距离</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span></span><br><span class="line"><span class="javascript"><span class="comment">// 猜你喜欢</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> &#123; guessRef, onScrolltolower &#125; = useGuessList()</span></span><br><span class="line"><span class="javascript"><span class="comment">// 弹出层组件</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> popup = ref&lt;UniHelper.UniPopupInstance&gt;()</span></span><br><span class="line"><span class="javascript"><span class="comment">// 取消原因列表</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> reasonList = ref([</span></span><br><span class="line"><span class="javascript">  <span class="string">&#x27;商品无货&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="string">&#x27;不想要了&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="string">&#x27;商品信息填错了&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="string">&#x27;地址信息填写错误&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="string">&#x27;商品降价&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="string">&#x27;其它&#x27;</span>,</span></span><br><span class="line"><span class="javascript">])</span></span><br><span class="line"><span class="javascript"><span class="comment">// 订单取消原因</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> reason = ref(<span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line"><span class="javascript"><span class="comment">// 复制内容</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onCopy = <span class="function">(<span class="params">id: string</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 设置系统剪贴板的内容</span></span></span><br><span class="line"><span class="javascript">  uni.setClipboardData(&#123; <span class="attr">data</span>: id &#125;)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取页面参数</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> query = defineProps&lt;&#123;</span></span><br><span class="line"><span class="javascript">  <span class="attr">id</span>: string</span></span><br><span class="line"><span class="javascript">&#125;&gt;()</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 自定义导航栏: 默认透明不可见, scroll-view 滚动到 50 时展示 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;navbar&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingTop: safeAreaInsets?.top + &#x27;px&#x27; &#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;wrap&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">v-if</span>=<span class="string">&quot;true&quot;</span> <span class="attr">open-type</span>=<span class="string">&quot;navigateBack&quot;</span> <span class="attr">class</span>=<span class="string">&quot;back icon-left&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">v-else</span> <span class="attr">url</span>=<span class="string">&quot;/pages/index/index&quot;</span> <span class="attr">open-type</span>=<span class="string">&quot;switchTab&quot;</span> <span class="attr">class</span>=<span class="string">&quot;back icon-home&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>订单详情<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">scroll-y</span> <span class="attr">class</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">id</span>=<span class="string">&quot;scroller&quot;</span> @<span class="attr">scrolltolower</span>=<span class="string">&quot;onScrolltolower&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 订单状态 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;overview&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingTop: safeAreaInsets!.top + 20 + &#x27;px&#x27; &#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 待付款状态:展示去支付按钮和倒计时 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;status icon-clock&quot;</span>&gt;</span>等待付款<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tips&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;money&quot;</span>&gt;</span>应付金额: ¥ 99.00<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;time&quot;</span>&gt;</span>支付剩余<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            00 时 29 分 59 秒</span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span>去支付<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 其他订单状态:展示再次购买按钮 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 订单状态文字 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;status&quot;</span>&gt;</span> 待付款 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button-group&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;button&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:url</span>=<span class="string">&quot;`/pagesOrder/create/create?orderId=$&#123;query.id&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              再次购买</span><br><span class="line">            <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 待发货状态：模拟发货,开发期间使用,用于修改订单状态为已发货 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">v-if</span>=<span class="string">&quot;false&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span> 模拟发货 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 配送状态 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;shipment&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 订单物流信息 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">v-for</span>=<span class="string">&quot;item in 1&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item&quot;</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;message&quot;</span>&gt;</span></span><br><span class="line">            您已在广州市天河区黑马程序员完成取件，感谢使用菜鸟驿站，期待再次为您服务。</span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;date&quot;</span>&gt;</span> 2023-04-14 13:14:20 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 用户收货地址 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;locate&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;user&quot;</span>&gt;</span> 张三 13333333333 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;address&quot;</span>&gt;</span> 广东省 广州市 天河区 黑马程序员 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- 商品信息 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;goods&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;navigator&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-for</span>=<span class="string">&quot;item in 2&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:key</span>=<span class="string">&quot;item&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:url</span>=<span class="string">&quot;`/pages/goods/goods?id=$&#123;item&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">image</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;cover&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">src</span>=<span class="string">&quot;https://yanxuan-item.nosdn.127.net/c07edde1047fa1bd0b795bed136c2bb2.jpg&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;meta&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;name ellipsis&quot;</span>&gt;</span>ins风小碎花泡泡袖衬110-160cm<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;type&quot;</span>&gt;</span>藏青小花， 130<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;price&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;actual&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;symbol&quot;</span>&gt;</span>¥<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">text</span>&gt;</span>99.00<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;quantity&quot;</span>&gt;</span>x1<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 待评价状态:展示按钮 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;action&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span>&gt;</span>申请售后<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span> 去评价 <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 合计 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;total&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>商品总价: <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;symbol&quot;</span>&gt;</span>99.00<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>运费: <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;symbol&quot;</span>&gt;</span>10.00<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>应付金额: <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;symbol primary&quot;</span>&gt;</span>109.00<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- 订单信息 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;detail&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>订单信息<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">            订单编号: &#123;&#123; query.id &#125;&#125; <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;copy&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;onCopy(query.id)&quot;</span>&gt;</span>复制<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span>下单时间: 2023-04-14 13:14:20<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- 猜你喜欢 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">XtxGuess</span> <span class="attr">ref</span>=<span class="string">&quot;guessRef&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- 底部操作栏 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;toolbar-height&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;toolbar&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 待付款状态:展示支付按钮 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span>&gt;</span> 去支付 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;popup?.open?.()&quot;</span>&gt;</span> 取消订单 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 其他订单状态:按需展示按钮 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;button secondary&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:url</span>=<span class="string">&quot;`/pagesOrder/create/create?orderId=$&#123;query.id&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            再次购买</span><br><span class="line">          <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 待收货状态: 展示确认收货 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span>&gt;</span> 确认收货 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 待评价状态: 展示去评价 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span> 去评价 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 待评价/已完成/已取消 状态: 展示删除订单 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button delete&quot;</span>&gt;</span> 删除订单 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 骨架屏组件 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PageSkeleton</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 取消订单弹窗 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">uni-popup</span> <span class="attr">ref</span>=<span class="string">&quot;popup&quot;</span> <span class="attr">type</span>=<span class="string">&quot;bottom&quot;</span> <span class="attr">background-color</span>=<span class="string">&quot;#fff&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;popup-root&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>订单取消<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;description&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tips&quot;</span>&gt;</span>请选择取消订单的原因：<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cell&quot;</span> <span class="attr">v-for</span>=<span class="string">&quot;item in reasonList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;reason = item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>&#123;&#123; item &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; checked: item === reason &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;footer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;popup?.close?.()&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span>&gt;</span>确认<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">uni-popup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">page &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.navbar</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">width</span>: <span class="number">750</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">color</span>: <span class="number">#000</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="css">  <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">z-index</span>: <span class="number">9</span>;</span></span><br><span class="line"><span class="css">  <span class="comment">/* background-color: #f8f8f8; */</span></span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: transparent;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.wrap</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.title</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">44px</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">32</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="comment">/* color: #000; */</span></span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: transparent;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.back</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">      <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">44px</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">width</span>: <span class="number">44px</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">44</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">      <span class="comment">/* color: #000; */</span></span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.viewport</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#f7f7f8</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.overview</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="css">  <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="attribute">line-height</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding-bottom</span>: <span class="number">30</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/order_bg.png</span>);</span></span><br><span class="line"><span class="css">  <span class="attribute">background-size</span>: cover;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.status</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">36</span>rpx;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.status</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-right</span>: <span class="number">6</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-weight</span>: <span class="number">500</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.tips</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin</span>: <span class="number">30</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.money</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-right</span>: <span class="number">30</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.button-group</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-top</span>: <span class="number">30</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.button</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">260</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">64</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">line-height</span>: <span class="number">64</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">border-radius</span>: <span class="number">68</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.shipment</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">line-height</span>: <span class="number">1.4</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">margin</span>: <span class="number">20</span>rpx <span class="number">20</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-radius</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.locate</span>,</span></span><br><span class="line"><span class="css">  <span class="selector-class">.item</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">min-height</span>: <span class="number">120</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">30</span>rpx <span class="number">30</span>rpx <span class="number">25</span>rpx <span class="number">75</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-size</span>: <span class="number">50</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-repeat</span>: no-repeat;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-position</span>: <span class="number">6</span>rpx center;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.locate</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/locate.png</span>);</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.user</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.address</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#666</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.item</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/car.png</span>);</span></span><br><span class="line"><span class="css">    <span class="attribute">border-bottom</span>: <span class="number">1</span>rpx solid <span class="number">#eee</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.message</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.date</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#666</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.goods</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">margin</span>: <span class="number">20</span>rpx <span class="number">20</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-radius</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.item</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">30</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">border-bottom</span>: <span class="number">1</span>rpx solid <span class="number">#eee</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.navigator</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin</span>: <span class="number">20</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.cover</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">width</span>: <span class="number">170</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">170</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-right</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.meta</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="css">      <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.name</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">80</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.type</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">line-height</span>: <span class="number">1.8</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">15</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-top</span>: <span class="number">6</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-self</span>: flex-start;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">4</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#888</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">background-color</span>: <span class="number">#f7f7f8</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.price</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-top</span>: <span class="number">6</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.symbol</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.original</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#999</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">text-decoration</span>: line-through;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.actual</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-left</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.text</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">22</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.quantity</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">      <span class="attribute">bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.action</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">flex-direction</span>: row-reverse;</span></span><br><span class="line"><span class="css">      <span class="attribute">justify-content</span>: flex-start;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding</span>: <span class="number">30</span>rpx <span class="number">0</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="selector-class">.button</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">width</span>: <span class="number">200</span>rpx;</span></span><br><span class="line"><span class="css">        <span class="attribute">height</span>: <span class="number">60</span>rpx;</span></span><br><span class="line"><span class="css">        <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">        <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">        <span class="attribute">line-height</span>: <span class="number">60</span>rpx;</span></span><br><span class="line"><span class="css">        <span class="attribute">margin-left</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">        <span class="attribute">border-radius</span>: <span class="number">60</span>rpx;</span></span><br><span class="line"><span class="css">        <span class="attribute">border</span>: <span class="number">1</span>rpx solid <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">        <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">      <span class="selector-class">.primary</span> &#123;</span></span><br><span class="line"><span class="css">        <span class="attribute">color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">        <span class="attribute">border-color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">      &#125;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.total</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">line-height</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">20</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#666</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.row</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding</span>: <span class="number">10</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.symbol</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">content</span>: <span class="string">&#x27;¥&#x27;</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">80%</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-right</span>: <span class="number">3</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.primary</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#cf4444</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">36</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.detail</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">line-height</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">30</span>rpx <span class="number">20</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">margin</span>: <span class="number">20</span>rpx <span class="number">20</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">color</span>: <span class="number">#666</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-radius</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.title</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">30</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.row</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">20</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.item</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding</span>: <span class="number">10</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.copy</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding</span>: <span class="number">5</span>rpx <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-left</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.toolbar-height</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">100</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">box-sizing</span>: content-box;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.toolbar</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="css">  <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">bottom</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--window-bottom));</span></span><br><span class="line"><span class="css">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">100</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">  <span class="attribute">flex-direction</span>: row-reverse;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-top</span>: <span class="number">1</span>rpx solid <span class="number">#ededed</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-bottom</span>: <span class="number">1</span>rpx solid <span class="number">#ededed</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">box-sizing</span>: content-box;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.button</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">200</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">72</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-left</span>: <span class="number">15</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">border-radius</span>: <span class="number">72</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">border</span>: <span class="number">1</span>rpx solid <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.delete</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">order</span>: <span class="number">4</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.button</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">order</span>: <span class="number">3</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.secondary</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">order</span>: <span class="number">2</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">border-color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.primary</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">order</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.popup-root</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">30</span>rpx <span class="number">30</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">border-radius</span>: <span class="number">10</span>rpx <span class="number">10</span>rpx <span class="number">0</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.title</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">30</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-bottom</span>: <span class="number">30</span>rpx;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.description</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.tips</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-bottom</span>: <span class="number">12</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.cell</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding</span>: <span class="number">15</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#666</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.icon</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">content</span>: <span class="string">&#x27;\e6cd&#x27;</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-family</span>: <span class="string">&#x27;erabbit&#x27;</span> <span class="meta">!important</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">38</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#999</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.icon</span><span class="selector-class">.checked</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">content</span>: <span class="string">&#x27;\e6cc&#x27;</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">38</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.footer</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">30</span>rpx <span class="number">0</span> <span class="number">40</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.button</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">72</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">line-height</span>: <span class="number">72</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">72</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">border</span>: <span class="number">1</span>rpx solid <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.primary</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">background-color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">border</span>: none;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="自定义导航栏交互"><a href="#自定义导航栏交互" class="headerlink" title="自定义导航栏交互"></a>自定义导航栏交互</h3><ol>
<li><p>导航栏左上角按钮：<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/reference/api/getCurrentPages.html">获取当前页面栈</a>，如果不能返回上一页，按钮变成返回首页。</p>
</li>
<li><p>导航栏动画效果：<a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/animation.html#%E6%BB%9A%E5%8A%A8%E9%A9%B1%E5%8A%A8%E7%9A%84%E5%8A%A8%E7%94%BB">滚动驱动的动画</a>，根据滚动位置而不断改变动画的进度。</p>
</li>
</ol>
<p>滚动驱动的动画目前只支持微信小程序端，暂不支持网页端。</p>
<p><img src="/resource/images/order_picture_2.gif" alt="导航栏交互"></p>
<p><code>pages.json</code></p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  <span class="string">&quot;subPackages&quot;</span>: [</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">&quot;root&quot;</span>: <span class="string">&quot;pagesOrder&quot;</span>,</span><br><span class="line">      <span class="string">&quot;pages&quot;</span>: [</span><br><span class="line">        <span class="comment">// ...</span></span><br><span class="line">        &#123;</span><br><span class="line">          <span class="string">&quot;path&quot;</span>: <span class="string">&quot;detail/detail&quot;</span>,</span><br><span class="line">          <span class="string">&quot;style&quot;</span>: &#123;</span><br><span class="line">            <span class="string">&quot;navigationBarTitleText&quot;</span>: <span class="string">&quot;订单详情&quot;</span>,</span><br><span class="line">            <span class="string">&quot;navigationStyle&quot;</span>: <span class="string">&quot;custom&quot;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>参考代码，<code>pagesOrder/detail/detail.vue</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取页面栈</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> pages = getCurrentPages()</span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取当前页面实例，数组最后一项</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> pageInstance = pages.at(-<span class="number">1</span>) <span class="keyword">as</span> any</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 页面渲染完毕，绑定动画效果</span></span></span><br><span class="line"><span class="javascript">onReady(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 动画效果,导航栏背景色</span></span></span><br><span class="line"><span class="javascript">  pageInstance.animate(</span></span><br><span class="line"><span class="javascript">    <span class="string">&#x27;.navbar&#x27;</span>, <span class="comment">// 选择器</span></span></span><br><span class="line"><span class="javascript">    [&#123; <span class="attr">backgroundColor</span>: <span class="string">&#x27;transparent&#x27;</span> &#125;, &#123; <span class="attr">backgroundColor</span>: <span class="string">&#x27;#f8f8f8&#x27;</span> &#125;], <span class="comment">// 关键帧信息</span></span></span><br><span class="line"><span class="javascript">    <span class="number">1000</span>, <span class="comment">// 动画持续时长</span></span></span><br><span class="line"><span class="javascript">    &#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">scrollSource</span>: <span class="string">&#x27;#scroller&#x27;</span>, <span class="comment">// scroll-view 的选择器</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">startScrollOffset</span>: <span class="number">0</span>, <span class="comment">// 开始滚动偏移量</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">endScrollOffset</span>: <span class="number">50</span>, <span class="comment">// 停止滚动偏移量</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">timeRange</span>: <span class="number">1000</span>, <span class="comment">// 时间长度</span></span></span><br><span class="line"><span class="javascript">    &#125;,</span></span><br><span class="line"><span class="javascript">  )</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 动画效果,导航栏标题</span></span></span><br><span class="line"><span class="javascript">  pageInstance.animate(<span class="string">&#x27;.navbar .title&#x27;</span>, [&#123; <span class="attr">color</span>: <span class="string">&#x27;transparent&#x27;</span> &#125;, &#123; <span class="attr">color</span>: <span class="string">&#x27;#000&#x27;</span> &#125;], <span class="number">1000</span>, &#123;</span></span><br><span class="line"><span class="javascript">    <span class="attr">scrollSource</span>: <span class="string">&#x27;#scroller&#x27;</span>,</span></span><br><span class="line"><span class="javascript">    <span class="attr">timeRange</span>: <span class="number">1000</span>,</span></span><br><span class="line"><span class="javascript">    <span class="attr">startScrollOffset</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="javascript">    <span class="attr">endScrollOffset</span>: <span class="number">50</span>,</span></span><br><span class="line"><span class="javascript">  &#125;)</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 动画效果,导航栏返回按钮</span></span></span><br><span class="line"><span class="javascript">  pageInstance.animate(<span class="string">&#x27;.navbar .back&#x27;</span>, [&#123; <span class="attr">color</span>: <span class="string">&#x27;#fff&#x27;</span> &#125;, &#123; <span class="attr">color</span>: <span class="string">&#x27;#000&#x27;</span> &#125;], <span class="number">1000</span>, &#123;</span></span><br><span class="line"><span class="javascript">    <span class="attr">scrollSource</span>: <span class="string">&#x27;#scroller&#x27;</span>,</span></span><br><span class="line"><span class="javascript">    <span class="attr">timeRange</span>: <span class="number">1000</span>,</span></span><br><span class="line"><span class="javascript">    <span class="attr">startScrollOffset</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="javascript">    <span class="attr">endScrollOffset</span>: <span class="number">50</span>,</span></span><br><span class="line"><span class="javascript">  &#125;)</span></span><br><span class="line"><span class="javascript">&#125;)</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 自定义导航栏: 默认透明不可见, scroll-view 滚动到 50 时展示 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;navbar&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingTop: safeAreaInsets?.top + &#x27;px&#x27; &#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;wrap&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-if</span>=<span class="string">&quot;pages.length &gt; 1&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">open-type</span>=<span class="string">&quot;navigateBack&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;back icon-left&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span><span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">v-else</span> <span class="attr">url</span>=<span class="string">&quot;/pages/index/index&quot;</span> <span class="attr">open-type</span>=<span class="string">&quot;switchTab&quot;</span> <span class="attr">class</span>=<span class="string">&quot;back icon-home&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>订单详情<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">class</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">scroll-y</span> <span class="attr">enable-back-to-top</span> <span class="attr">id</span>=<span class="string">&quot;scroller&quot;</span>&gt;</span></span><br><span class="line">    ...滚动容器</span><br><span class="line">  <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-10"><a href="#小结一下-10" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-10_09-07-02.png"/>

<h2 id="获取订单详情"><a href="#获取订单详情" class="headerlink" title="获取订单详情"></a>获取订单详情</h2><ol>
<li>声明后端返回数据的类型，<code>src/types/order.d.ts</code>。</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 订单详情 返回信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> OrderResult = &#123;</span><br><span class="line">  <span class="comment">/** 订单编号 */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 订单状态，1为待付款、2为待发货、3为待收货、4为待评价、5为已完成、6为已取消 */</span></span><br><span class="line">  <span class="attr">orderState</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 倒计时--剩余的秒数 -1 表示已经超时，正数表示倒计时未结束 */</span></span><br><span class="line">  <span class="attr">countdown</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 商品集合 [ 商品信息 ] */</span></span><br><span class="line">  <span class="attr">skus</span>: OrderSkuItem[]</span><br><span class="line">  <span class="comment">/** 收货人 */</span></span><br><span class="line">  <span class="attr">receiverContact</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 收货人手机 */</span></span><br><span class="line">  <span class="attr">receiverMobile</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 收货人完整地址 */</span></span><br><span class="line">  <span class="attr">receiverAddress</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 下单时间 */</span></span><br><span class="line">  <span class="attr">createTime</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品总价 */</span></span><br><span class="line">  <span class="attr">totalMoney</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 运费 */</span></span><br><span class="line">  <span class="attr">postFee</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 应付金额 */</span></span><br><span class="line">  <span class="attr">payMoney</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 商品信息 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> OrderSkuItem = &#123;</span><br><span class="line">  <span class="comment">/** sku id */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品 id */</span></span><br><span class="line">  <span class="attr">spuId</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品名称 */</span></span><br><span class="line">  <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 商品属性文字 */</span></span><br><span class="line">  <span class="attr">attrsText</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 数量 */</span></span><br><span class="line">  <span class="attr">quantity</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 购买时单价 */</span></span><br><span class="line">  <span class="attr">curPrice</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 图片地址 */</span></span><br><span class="line">  <span class="attr">image</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>接口封装，<code>services/order.ts</code>。</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; OrderResult &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/order&#x27;</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取订单详情</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>id 订单id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getMemberOrderByIdAPI = <span class="function">(<span class="params">id: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;OrderResult&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>页面中调用，<code>pagesOrder/detail/detai.vue</code>。</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; onLoad &#125; <span class="keyword">from</span> <span class="string">&#x27;@dcloudio/uni-app&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; OrderResult &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/order&#x27;</span></span><br><span class="line"><span class="keyword">const</span> order = ref&lt;OrderResult&gt;()</span><br><span class="line"><span class="keyword">const</span> getMemberOrderByIdData = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> getMemberOrderByIdAPI(query.id)</span><br><span class="line">  order.value = res.result</span><br><span class="line">&#125;</span><br><span class="line">onLoad(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  getMemberOrderByIdData()</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

<h2 id="渲染订单状态"><a href="#渲染订单状态" class="headerlink" title="渲染订单状态"></a>渲染订单状态</h2><h3 id="基本内容"><a href="#基本内容" class="headerlink" title="基本内容"></a>基本内容</h3><p>在订单详情中除了展示订单信息外，还需要根据不同<strong>订单状态</strong>展示不同的内容。</p>
<table>
<thead>
<tr>
<th>订单状态（orderState）</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>待付款</td>
</tr>
<tr>
<td>2</td>
<td>待发货</td>
</tr>
<tr>
<td>3</td>
<td>待收货</td>
</tr>
<tr>
<td>4</td>
<td>待评价</td>
</tr>
<tr>
<td>5</td>
<td>已完成</td>
</tr>
<tr>
<td>6</td>
<td>已取消</td>
</tr>
</tbody></table>
<p>枚举的作用：通过枚举来替代无意义的<strong>订单状态</strong>数字，提高程序的可读性。</p>
<ol>
<li>定义枚举，<code>src/services/constants.ts</code>。</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 订单状态枚举 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="built_in">enum</span> OrderState &#123;</span><br><span class="line">  <span class="comment">/** 待付款 */</span></span><br><span class="line">  DaiFuKuan = <span class="number">1</span>,</span><br><span class="line">  <span class="comment">/** 待发货 */</span></span><br><span class="line">  DaiFaHuo = <span class="number">2</span>,</span><br><span class="line">  <span class="comment">/** 待收货 */</span></span><br><span class="line">  DaiShouHuo = <span class="number">3</span>,</span><br><span class="line">  <span class="comment">/** 待评价 */</span></span><br><span class="line">  DaiPingJia = <span class="number">4</span>,</span><br><span class="line">  <span class="comment">/** 已完成 */</span></span><br><span class="line">  YiWanCheng = <span class="number">5</span>,</span><br><span class="line">  <span class="comment">/** 已取消 */</span></span><br><span class="line">  YiQuXiao = <span class="number">6</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 订单状态列表 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> orderStateList = [</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">text</span>: <span class="string">&#x27;&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">&#x27;待付款&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">&#x27;待发货&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">text</span>: <span class="string">&#x27;待收货&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">text</span>: <span class="string">&#x27;待评价&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">5</span>, <span class="attr">text</span>: <span class="string">&#x27;已完成&#x27;</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">id</span>: <span class="number">6</span>, <span class="attr">text</span>: <span class="string">&#x27;已取消&#x27;</span> &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>根据后端返回的数据渲染订单详情，<code>pagesOrder/detail/detail.vue</code>。</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- #1 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;order&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 订单状态 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;overview&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingTop: safeAreaInsets!.top + 20 + &#x27;px&#x27; &#125;&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 待付款状态:展示去支付按钮和倒计时 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- #2 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;order.orderState === OrderState.DaiFuKuan&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;status icon-clock&quot;</span>&gt;</span>等待付款<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tips&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;money&quot;</span>&gt;</span>应付金额: ¥ 99.00<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;time&quot;</span>&gt;</span>支付剩余<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        00 时 29 分 59 秒</span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span>去支付<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 其他订单状态:展示再次购买按钮 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 订单状态文字 --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- #3 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;status&quot;</span>&gt;</span></span><br><span class="line">        &#123;&#123; orderStateList[order.orderState].text &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button-group&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;button&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:url</span>=<span class="string">&quot;`/pagesOrder/create/create?orderId=$&#123;query.id&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">          再次购买</span><br><span class="line">        <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 待发货状态：模拟发货,开发期间使用,用于修改订单状态为已发货 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">v-if</span>=<span class="string">&quot;false&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span> 模拟发货 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 配送状态 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 商品信息 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 订单信息 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 猜你喜欢 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 底部操作栏 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- ... --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-11"><a href="#小结一下-11" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-10_09-23-02.png"/>

<h2 id="支付倒计时"><a href="#支付倒计时" class="headerlink" title="支付倒计时"></a>支付倒计时</h2><h3 id="参考代码-5"><a href="#参考代码-5" class="headerlink" title="参考代码"></a>参考代码</h3><p>通过 uni-ui 组件库的 <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/component/uniui/uni-countdown.html">uni-countdown</a> 实现倒计时。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 倒计时结束事件</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onTimeup = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 修改订单状态为已取消</span></span></span><br><span class="line"><span class="javascript">  order.value!.orderState = OrderState.YiQuXiao</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 待付款状态:展示去支付按钮和倒计时 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;order.orderState === OrderState.DaiFuKuan&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;status icon-clock&quot;</span>&gt;</span>等待付款<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tips&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;money&quot;</span>&gt;</span>应付金额: ¥ 99.00<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;time&quot;</span>&gt;</span>支付剩余<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 倒计时组件 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">uni-countdown</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:second</span>=<span class="string">&quot;order.countdown&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">color</span>=<span class="string">&quot;#fff&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">splitor-color</span>=<span class="string">&quot;#fff&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:show-day</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:show-colon</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">        @<span class="attr">timeup</span>=<span class="string">&quot;onTimeup&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span>去支付<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-12"><a href="#小结一下-12" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-10_10-16-50.png"/>

<h2 id="订单支付"><a href="#订单支付" class="headerlink" title="订单支付"></a>订单支付</h2><p>订单支付其实就是根据订单号查询到支付信息，在小程序中调用微信支付的 API 而已。</p>
<h3 id="微信支付说明"><a href="#微信支付说明" class="headerlink" title="微信支付说明"></a>微信支付说明</h3><ol>
<li><p>由于微信支付的限制，仅 <strong>appid</strong> 为 <code>wx26729f20b9efae3a</code> 的开发者才能调用该接口。此外，开发者还需要微信授权登录。</p>
</li>
<li><p>对于其他开发者，可以使用<strong>模拟支付接口</strong>进行开发测试，调用后，订单状态将自动更新为已支付。</p>
</li>
</ol>
<p><strong>调用接口</strong></p>
<ul>
<li><p>生产环境：调用正式接口，获取微信支付参数 + 发起微信支付。</p>
</li>
<li><p>开发环境：调用模拟接口，通过模拟支付，修改订单状态为已支付。</p>
</li>
</ul>
<p><code>services/pay.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; http &#125; <span class="keyword">from</span> <span class="string">&#x27;@/utils/http&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取微信支付参数</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>data orderId 订单id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getPayWxPayMiniPayAPI = <span class="function">(<span class="params">data: &#123; orderId: <span class="built_in">string</span> &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;WechatMiniprogram.RequestPaymentOption&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/pay/wxPay/miniPay&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 模拟支付-内测版</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>data orderId 订单id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getPayMockAPI = <span class="function">(<span class="params">data: &#123; orderId: <span class="built_in">string</span> &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">&#x27;/pay/mock&#x27;</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="参考代码-6"><a href="#参考代码-6" class="headerlink" title="参考代码"></a>参考代码</h3><p>通过<a target="_blank" rel="noopener" href="https://cn.vitejs.dev/guide/env-and-mode.html">环境变量</a>区分开发环境，调用不同接口，<code>pagesOrder/detail/detail.vue</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; getPayMockAPI, getPayWxPayMiniPayAPI &#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/pay&#x27;</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 订单支付</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onOrderPay = <span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 通过环境变量区分开发环境</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (<span class="keyword">import</span>.meta.env.DEV) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 开发环境：模拟支付，修改订单状态为已支付</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">await</span> getPayMockAPI(&#123; <span class="attr">orderId</span>: query.id &#125;)</span></span><br><span class="line"><span class="javascript">  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 生产环境：获取支付参数 + 发起微信支付</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> res = <span class="keyword">await</span> getPayWxPayMiniPayAPI(&#123; <span class="attr">orderId</span>: query.id &#125;)</span></span><br><span class="line"><span class="javascript">    <span class="keyword">await</span> wx.requestPayment(res.result)</span></span><br><span class="line"><span class="javascript">  &#125;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 关闭当前页，再跳转支付结果页</span></span></span><br><span class="line"><span class="javascript">  uni.redirectTo(&#123; <span class="attr">url</span>: <span class="string">`/pagesOrder/payment/payment?id=<span class="subst">$&#123;query.id&#125;</span>`</span> &#125;)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;onOrderPay&quot;</span>&gt;</span>去支付<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>注意真实支付，需要修改 <code>pages/login/login.vue</code> 中的登录方式。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;button phone&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">open-type</span>=<span class="string">&quot;getPhoneNumber&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">getphonenumber</span>=<span class="string">&quot;onGetphonenumber&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;icon icon-phone&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  手机号快捷登录</span><br><span class="line"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="支付成功页"><a href="#支付成功页" class="headerlink" title="支付成功页"></a>支付成功页</h3><p>主要用于展示支付结果，<code>src/pagesOrder/payment/payment.vue</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; useGuessList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/composables&#x27;</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取页面参数</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> query = defineProps&lt;&#123;</span></span><br><span class="line"><span class="javascript">  <span class="attr">id</span>: string</span></span><br><span class="line"><span class="javascript">&#125;&gt;()</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 猜你喜欢</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> &#123; guessRef, onScrolltolower &#125; = useGuessList()</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">class</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">scroll-y</span> @<span class="attr">scrolltolower</span>=<span class="string">&quot;onScrolltolower&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 订单状态 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;overview&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;status icon-checked&quot;</span>&gt;</span>支付成功<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;buttons&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">          <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;button navigator&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">url</span>=<span class="string">&quot;/pages/index/index&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">open-type</span>=<span class="string">&quot;switchTab&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">          返回首页</span><br><span class="line">        <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">          <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;button navigator&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:url</span>=<span class="string">&quot;`/pagesOrder/detail/detail?id=$&#123;query.id&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">open-type</span>=<span class="string">&quot;redirect&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">          查看订单</span><br><span class="line">        <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 猜你喜欢 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">XtxGuess</span> <span class="attr">ref</span>=<span class="string">&quot;guessRef&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">page &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.viewport</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#f7f7f8</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.overview</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">line-height</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">50</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.status</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">36</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-weight</span>: <span class="number">500</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.status</span><span class="selector-pseudo">::before</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: block;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">110</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-bottom</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.buttons</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">60</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">line-height</span>: <span class="number">60</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-top</span>: <span class="number">60</span>rpx;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.button</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    &amp;<span class="selector-pseudo">:first</span>-child &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">width</span>: <span class="number">200</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">64</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">border</span>: <span class="number">1</span>rpx solid <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-13"><a href="#小结一下-13" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-10_10-41-32.png"/>

<h2 id="模拟发货"><a href="#模拟发货" class="headerlink" title="模拟发货"></a>模拟发货</h2><h3 id="基本内容-1"><a href="#基本内容-1" class="headerlink" title="基本内容"></a>基本内容</h3><p>仅在订单状态为待发货时，可模拟发货，调用后订单状态修改为待收货，包含模拟物流。</p>
<p><strong>仅在开发期间使用</strong>，项目上线后应该是由商家发货。</p>
<p><strong>接口封装</strong>，<code>src/services/order.ts</code>。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 模拟发货-内测版</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description </span>在DEV环境下使用，仅在订单状态为待发货时，可模拟发货，调用后订单状态修改为待收货，包含模拟物流。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>id 订单id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getMemberOrderConsignmentByIdAPI = <span class="function">(<span class="params">id: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order/consignment/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong>，<code>pagesOrder/detail/detail.vue</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; getMemberOrderConsignmentByIdAPI &#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/order&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="comment">// 是否为开发环境</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> isDev = <span class="keyword">import</span>.meta.env.DEV</span></span><br><span class="line"><span class="javascript"><span class="comment">// 模拟发货</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onOrderSend = <span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (isDev) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">await</span> getMemberOrderConsignmentByIdAPI(query.id)</span></span><br><span class="line"><span class="javascript">    uni.showToast(&#123; <span class="attr">icon</span>: <span class="string">&#x27;success&#x27;</span>, <span class="attr">title</span>: <span class="string">&#x27;模拟发货完成&#x27;</span> &#125;)</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 主动更新订单状态</span></span></span><br><span class="line"><span class="javascript">    order.value!.orderState = OrderState.DaiShouHuo</span></span><br><span class="line"><span class="javascript">  &#125;</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 待发货状态：模拟发货,开发期间使用,用于修改订单状态为已发货 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">v-if</span>=<span class="string">&quot;isDev &amp;&amp; order.orderState == OrderState.DaiFaHuo&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;onOrderSend&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span></span><br><span class="line">    模拟发货</span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-14"><a href="#小结一下-14" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-10_11-24-34.png"/>

<h2 id="确认收货"><a href="#确认收货" class="headerlink" title="确认收货"></a>确认收货</h2><h3 id="基本内容-2"><a href="#基本内容-2" class="headerlink" title="基本内容"></a>基本内容</h3><p>点击确认收货时需二次确认，提示文案：<strong>为保障您的权益，请收到货并确认无误后，再确认收货</strong></p>
<p><strong>接口封装</strong>，<code>services/order.ts</code>。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 确认收货</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description </span>仅在订单状态为待收货时，可确认收货。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>id 订单id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> putMemberOrderReceiptByIdAPI = <span class="function">(<span class="params">id: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;OrderResult&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;PUT&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order/<span class="subst">$&#123;id&#125;</span>/receipt`</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>参考代码</strong>，<code>pagesOrder/detail/detail.vue</code>。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 确认收货</span></span><br><span class="line"><span class="keyword">const</span> onOrderConfirm = <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 二次确认弹窗</span></span><br><span class="line">  uni.showModal(&#123;</span><br><span class="line">    <span class="attr">content</span>: <span class="string">&#x27;为保障您的权益，请收到货并确认无误后，再确认收货&#x27;</span>,</span><br><span class="line">    <span class="attr">success</span>: <span class="keyword">async</span> (success) =&gt; &#123;</span><br><span class="line">      <span class="keyword">if</span> (success.confirm) &#123;</span><br><span class="line">        <span class="keyword">const</span> res = <span class="keyword">await</span> putMemberOrderReceiptByIdAPI(query.id)</span><br><span class="line">        <span class="comment">// 更新订单状态</span></span><br><span class="line">        order.value = res.result</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button-group&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;button&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:url</span>=<span class="string">&quot;`/pagesOrder/create/create?orderId=$&#123;query.id&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    再次购买</span><br><span class="line">  <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 待发货状态：模拟发货,开发期间使用,用于修改订单状态为已发货 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-if</span>=<span class="string">&quot;isDev &amp;&amp; order.orderState === OrderState.DaiFaHuo&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;button&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">tap</span>=<span class="string">&quot;onOrderSend&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    模拟发货</span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-if</span>=<span class="string">&quot;order.orderState === OrderState.DaiShouHuo&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">tap</span>=<span class="string">&quot;onOrderConfirm&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;button&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    确认收货</span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;toolbar&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 待付款状态:展示支付按钮 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;order.orderState === OrderState.DaiFuKuan&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;onOrderPay&quot;</span>&gt;</span> 去支付 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;popup?.open?.()&quot;</span>&gt;</span> 取消订单 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 其他订单状态:按需展示按钮 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;button secondary&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:url</span>=<span class="string">&quot;`/pagesOrder/create/create?orderId=$&#123;query.id&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      再次购买</span><br><span class="line">    <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 待收货状态: 展示确认收货 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-if</span>=<span class="string">&quot;order.orderState === OrderState.DaiShouHuo&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">tap</span>=<span class="string">&quot;onOrderConfirm&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      确认收货</span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 待评价状态: 展示去评价 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span> 去评价 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 待评价/已完成/已取消 状态: 展示删除订单 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button delete&quot;</span>&gt;</span> 删除订单 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-15"><a href="#小结一下-15" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-10_11-28-26.png"/>

<h2 id="订单物流"><a href="#订单物流" class="headerlink" title="订单物流"></a>订单物流</h2><p>仅在订单状态为<strong>待收货，待评价，已完成</strong>时，可获取物流信息。</p>
<h3 id="请求封装"><a href="#请求封装" class="headerlink" title="请求封装"></a>请求封装</h3><p><code>types/order.d.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/** 物流信息 返回值类型 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> OrderLogisticResult = &#123;</span><br><span class="line">  <span class="comment">/** 快递公司 */</span></span><br><span class="line">  <span class="attr">company</span>: &#123;</span><br><span class="line">    <span class="comment">/** 公司名称 */</span></span><br><span class="line">    <span class="attr">name</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="comment">/** 快递编号 */</span></span><br><span class="line">    <span class="attr">number</span>: <span class="built_in">string</span></span><br><span class="line">    <span class="comment">/** 联系电话 */</span></span><br><span class="line">    <span class="attr">tel</span>: <span class="built_in">string</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">/** 商品件数 */</span></span><br><span class="line">  <span class="attr">count</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 物流日志 */</span></span><br><span class="line">  <span class="attr">list</span>: LogisticItem[]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 物流日志 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> LogisticItem = &#123;</span><br><span class="line">  <span class="comment">/** 信息ID */</span></span><br><span class="line">  <span class="attr">id</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 信息文字 */</span></span><br><span class="line">  <span class="attr">text</span>: <span class="built_in">string</span></span><br><span class="line">  <span class="comment">/** 时间 */</span></span><br><span class="line">  <span class="attr">time</span>: <span class="built_in">string</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>services/order.ts</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; OrderLogisticResult &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/order&#x27;</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取订单物流</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description </span>仅在订单状态为待收货，待评价，已完成时，可获取物流信息。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>id 订单id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getMemberOrderLogisticsByIdAPI = <span class="function">(<span class="params">id: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;OrderLogisticResult&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order/<span class="subst">$&#123;id&#125;</span>/logistics`</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>页面中调用，<code>pagesOrder/detail/detail.vue</code>。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> order = ref&lt;OrderResult&gt;()</span><br><span class="line"><span class="comment">// #1</span></span><br><span class="line"><span class="keyword">const</span> logisticList = ref&lt;LogisticItem[]&gt;([])</span><br><span class="line"><span class="comment">// #2</span></span><br><span class="line"><span class="keyword">const</span> getMemberOrderLogisticsByIdData = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> getMemberOrderLogisticsByIdAPI(query.id)</span><br><span class="line">  logisticList.value = res.result.list</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> getMemberOrderByIdData = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> getMemberOrderByIdAPI(query.id)</span><br><span class="line">  order.value = res.result</span><br><span class="line">  <span class="comment">// #3</span></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    [</span><br><span class="line">      OrderState.DaiShouHuo,</span><br><span class="line">      OrderState.DaiPingJia,</span><br><span class="line">      OrderState.YiWanCheng</span><br><span class="line">    ].includes(order.value.orderState)</span><br><span class="line">  ) &#123;</span><br><span class="line">    getMemberOrderLogisticsByIdData()</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;shipment&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- #4 订单物流信息 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">v-for</span>=<span class="string">&quot;item in logisticList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;message&quot;</span>&gt;</span></span><br><span class="line">      &#123;&#123; item.text &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;date&quot;</span>&gt;</span> &#123;&#123; item.time &#125;&#125; <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 用户收货地址 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;locate&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">      &#123;&#123; order.receiverContact &#125;&#125; &#123;&#123; order.receiverMobile &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;address&quot;</span>&gt;</span> &#123;&#123; order.receiverAddress &#125;&#125; <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-16"><a href="#小结一下-16" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-10_11-36-04.png"/>

<h2 id="删除订单"><a href="#删除订单" class="headerlink" title="删除订单"></a>删除订单</h2><p>仅在订单状态为<strong>待评价，已完成，已取消</strong>时，可删除订单。</p>
<h3 id="接口封装-4"><a href="#接口封装-4" class="headerlink" title="接口封装"></a>接口封装</h3><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 删除订单</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description </span>仅在订单状态为待评价，已完成，已取消时，可删除订单。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>data ids 订单集合</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> deleteMemberOrderAPI = <span class="function">(<span class="params">data: &#123; ids: <span class="built_in">string</span>[] &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;DELETE&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order`</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="代码展示"><a href="#代码展示" class="headerlink" title="代码展示"></a>代码展示</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; useGuessList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/composables&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; getMemberOrderByIdAPI &#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/order&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> type &#123; OrderResult &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/order&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; onLoad, onReady &#125; <span class="keyword">from</span> <span class="string">&#x27;@dcloudio/uni-app&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; OrderState, orderStateList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/constants&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; getPayMockAPI, getPayWxPayMiniPayAPI &#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/pay&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123;</span></span><br><span class="line"><span class="javascript">  getMemberOrderConsignmentByIdAPI,</span></span><br><span class="line"><span class="javascript">  putMemberOrderReceiptByIdAPI</span></span><br><span class="line"><span class="javascript">&#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/order&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> type &#123; LogisticItem &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/order&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123;</span></span><br><span class="line"><span class="javascript">  getMemberOrderLogisticsByIdAPI,</span></span><br><span class="line"><span class="javascript">  deleteMemberOrderAPI</span></span><br><span class="line"><span class="javascript">&#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/order&#x27;</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取屏幕边界到安全区域距离</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span></span><br><span class="line"><span class="javascript"><span class="comment">// 猜你喜欢</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> &#123; guessRef, onScrolltolower &#125; = useGuessList()</span></span><br><span class="line"><span class="javascript"><span class="comment">// 弹出层组件</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> popup = ref&lt;UniHelper.UniPopupInstance&gt;()</span></span><br><span class="line"><span class="javascript"><span class="comment">// 取消原因列表</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> reasonList = ref([</span></span><br><span class="line"><span class="javascript">  <span class="string">&#x27;商品无货&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="string">&#x27;不想要了&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="string">&#x27;商品信息填错了&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="string">&#x27;地址信息填写错误&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="string">&#x27;商品降价&#x27;</span>,</span></span><br><span class="line"><span class="javascript">  <span class="string">&#x27;其它&#x27;</span></span></span><br><span class="line"><span class="javascript">])</span></span><br><span class="line"><span class="javascript"><span class="comment">// 订单取消原因</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> reason = ref(<span class="string">&#x27;&#x27;</span>)</span></span><br><span class="line"><span class="javascript"><span class="comment">// 复制内容</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onCopy = <span class="function">(<span class="params">id: string</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 设置系统剪贴板的内容</span></span></span><br><span class="line"><span class="javascript">  uni.setClipboardData(&#123; <span class="attr">data</span>: id &#125;)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取页面参数</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> query = defineProps&lt;&#123;</span></span><br><span class="line"><span class="javascript">  <span class="attr">id</span>: string</span></span><br><span class="line"><span class="javascript">&#125;&gt;()</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> order = ref&lt;OrderResult&gt;()</span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> logisticList = ref&lt;LogisticItem[]&gt;([])</span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> getMemberOrderLogisticsByIdData = <span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> res = <span class="keyword">await</span> getMemberOrderLogisticsByIdAPI(query.id)</span></span><br><span class="line"><span class="javascript">  logisticList.value = res.result.list</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> getMemberOrderByIdData = <span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> res = <span class="keyword">await</span> getMemberOrderByIdAPI(query.id)</span></span><br><span class="line"><span class="javascript">  order.value = res.result</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (</span></span><br><span class="line"><span class="javascript">    [</span></span><br><span class="line"><span class="javascript">      OrderState.DaiShouHuo,</span></span><br><span class="line"><span class="javascript">      OrderState.DaiPingJia,</span></span><br><span class="line"><span class="javascript">      OrderState.YiWanCheng</span></span><br><span class="line"><span class="javascript">    ].includes(order.value.orderState)</span></span><br><span class="line"><span class="javascript">  ) &#123;</span></span><br><span class="line"><span class="javascript">    getMemberOrderLogisticsByIdData()</span></span><br><span class="line"><span class="javascript">  &#125;</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript">onLoad(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  getMemberOrderByIdData()</span></span><br><span class="line"><span class="javascript">&#125;)</span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取页面栈</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> pages = getCurrentPages()</span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取当前页面实例，数组最后一项</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> pageInstance = pages.at(-<span class="number">1</span>) <span class="keyword">as</span> any</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript">onReady(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  pageInstance.animate(</span></span><br><span class="line"><span class="javascript">    <span class="string">&#x27;.navbar&#x27;</span>, <span class="comment">// 选择器</span></span></span><br><span class="line"><span class="javascript">    [&#123; <span class="attr">backgroundColor</span>: <span class="string">&#x27;transparent&#x27;</span> &#125;, &#123; <span class="attr">backgroundColor</span>: <span class="string">&#x27;#f8f8f8&#x27;</span> &#125;], <span class="comment">// 关键帧信息</span></span></span><br><span class="line"><span class="javascript">    <span class="number">1000</span>, <span class="comment">// 动画持续时长</span></span></span><br><span class="line"><span class="javascript">    &#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">scrollSource</span>: <span class="string">&#x27;#scroller&#x27;</span>, <span class="comment">// scroll-view 的选择器</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">startScrollOffset</span>: <span class="number">0</span>, <span class="comment">// 开始滚动偏移量</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">endScrollOffset</span>: <span class="number">50</span>, <span class="comment">// 停止滚动偏移量</span></span></span><br><span class="line"><span class="javascript">      <span class="attr">timeRange</span>: <span class="number">1000</span> <span class="comment">// 时间长度</span></span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript">  )</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 动画效果,导航栏标题</span></span></span><br><span class="line"><span class="javascript">  pageInstance.animate(</span></span><br><span class="line"><span class="javascript">    <span class="string">&#x27;.navbar .title&#x27;</span>,</span></span><br><span class="line"><span class="javascript">    [&#123; <span class="attr">color</span>: <span class="string">&#x27;transparent&#x27;</span> &#125;, &#123; <span class="attr">color</span>: <span class="string">&#x27;#000&#x27;</span> &#125;],</span></span><br><span class="line"><span class="javascript">    <span class="number">1000</span>,</span></span><br><span class="line"><span class="javascript">    &#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">scrollSource</span>: <span class="string">&#x27;#scroller&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">timeRange</span>: <span class="number">1000</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">startScrollOffset</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">endScrollOffset</span>: <span class="number">50</span></span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript">  )</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 动画效果,导航栏返回按钮</span></span></span><br><span class="line"><span class="javascript">  pageInstance.animate(</span></span><br><span class="line"><span class="javascript">    <span class="string">&#x27;.navbar .back&#x27;</span>,</span></span><br><span class="line"><span class="javascript">    [&#123; <span class="attr">color</span>: <span class="string">&#x27;#fff&#x27;</span> &#125;, &#123; <span class="attr">color</span>: <span class="string">&#x27;#000&#x27;</span> &#125;],</span></span><br><span class="line"><span class="javascript">    <span class="number">1000</span>,</span></span><br><span class="line"><span class="javascript">    &#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">scrollSource</span>: <span class="string">&#x27;#scroller&#x27;</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">timeRange</span>: <span class="number">1000</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">startScrollOffset</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="javascript">      <span class="attr">endScrollOffset</span>: <span class="number">50</span></span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript">  )</span></span><br><span class="line"><span class="javascript">&#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onOrderPay = <span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (<span class="keyword">import</span>.meta.env.DEV) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">await</span> getPayMockAPI(&#123; <span class="attr">orderId</span>: query.id &#125;)</span></span><br><span class="line"><span class="javascript">  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 生产环境：获取支付参数 + 发起微信支付</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> res = <span class="keyword">await</span> getPayWxPayMiniPayAPI(&#123; <span class="attr">orderId</span>: query.id &#125;)</span></span><br><span class="line"><span class="javascript">    <span class="keyword">await</span> wx.requestPayment(res.result)</span></span><br><span class="line"><span class="javascript">  &#125;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 关闭当前页，再跳转支付结果页</span></span></span><br><span class="line"><span class="javascript">  uni.redirectTo(&#123; <span class="attr">url</span>: <span class="string">`/pagesOrder/payment/payment?id=<span class="subst">$&#123;query.id&#125;</span>`</span> &#125;)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> isDev = <span class="keyword">import</span>.meta.env.DEV</span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onOrderSend = <span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (isDev) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">await</span> getMemberOrderConsignmentByIdAPI(query.id)</span></span><br><span class="line"><span class="javascript">    uni.showToast(&#123; <span class="attr">icon</span>: <span class="string">&#x27;success&#x27;</span>, <span class="attr">title</span>: <span class="string">&#x27;模拟发货完成&#x27;</span> &#125;)</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 主动更新订单状态</span></span></span><br><span class="line"><span class="javascript">    order.value!.orderState = OrderState.DaiShouHuo</span></span><br><span class="line"><span class="javascript">  &#125;</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onOrderConfirm = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 二次确认弹窗</span></span></span><br><span class="line"><span class="javascript">  uni.showModal(&#123;</span></span><br><span class="line"><span class="javascript">    <span class="attr">content</span>: <span class="string">&#x27;为保障您的权益，请收到货并确认无误后，再确认收货&#x27;</span>,</span></span><br><span class="line"><span class="javascript">    <span class="attr">success</span>: <span class="keyword">async</span> (success) =&gt; &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span> (success.confirm) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">const</span> res = <span class="keyword">await</span> putMemberOrderReceiptByIdAPI(query.id)</span></span><br><span class="line"><span class="javascript">        <span class="comment">// 更新订单状态</span></span></span><br><span class="line"><span class="javascript">        order.value = res.result</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript">  &#125;)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// #3 倒计时结束事件</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onTimeup = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 修改订单状态为已取消</span></span></span><br><span class="line"><span class="javascript">  order.value!.orderState = OrderState.YiQuXiao</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// #12</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onOrderDelete = <span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  uni.showModal(&#123;</span></span><br><span class="line"><span class="javascript">    <span class="attr">content</span>: <span class="string">&#x27;是否删除订单&#x27;</span>,</span></span><br><span class="line"><span class="javascript">    <span class="attr">success</span>: <span class="keyword">async</span> (success) =&gt; &#123;</span></span><br><span class="line"><span class="javascript">      <span class="keyword">if</span> (success.confirm) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">await</span> deleteMemberOrderAPI(&#123; <span class="attr">ids</span>: [query.id] &#125;)</span></span><br><span class="line"><span class="javascript">        uni.redirectTo(&#123; <span class="attr">url</span>: <span class="string">&#x27;/pagesOrder/list/list&#x27;</span> &#125;)</span></span><br><span class="line"><span class="javascript">      &#125;</span></span><br><span class="line"><span class="javascript">    &#125;</span></span><br><span class="line"><span class="javascript">  &#125;)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 自定义导航栏: 默认透明不可见, scroll-view 滚动到 50 时展示 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;navbar&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingTop: safeAreaInsets?.top + &#x27;px&#x27; &#125;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;wrap&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-if</span>=<span class="string">&quot;pages.length &gt; 1&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">open-type</span>=<span class="string">&quot;navigateBack&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;back icon-left&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span><span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-else</span></span></span><br><span class="line"><span class="tag">        <span class="attr">url</span>=<span class="string">&quot;/pages/index/index&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">open-type</span>=<span class="string">&quot;switchTab&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;back icon-home&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>订单详情<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scroll-view</span></span></span><br><span class="line"><span class="tag">    <span class="attr">scroll-y</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;viewport&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">id</span>=<span class="string">&quot;scroller&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">scrolltolower</span>=<span class="string">&quot;onScrolltolower&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- #1 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;order&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 订单状态 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;overview&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingTop: safeAreaInsets!.top + 20 + &#x27;px&#x27; &#125;&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 待付款状态:展示去支付按钮和倒计时 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- #2 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;order.orderState === OrderState.DaiFuKuan&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;status icon-clock&quot;</span>&gt;</span>等待付款<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tips&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- #1 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;money&quot;</span>&gt;</span>应付金额: ¥ &#123;&#123; order.payMoney &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;time&quot;</span>&gt;</span>支付剩余<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- #2 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">uni-countdown</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:second</span>=<span class="string">&quot;order.countdown&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">color</span>=<span class="string">&quot;#fff&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">splitor-color</span>=<span class="string">&quot;#fff&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:show-day</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:show-colon</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">              @<span class="attr">timeup</span>=<span class="string">&quot;onTimeup&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;onOrderPay&quot;</span>&gt;</span>去支付<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 其他订单状态:展示再次购买按钮 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 订单状态文字 --&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- #3 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;status&quot;</span>&gt;</span></span><br><span class="line">            &#123;&#123; orderStateList[order.orderState].text &#125;&#125;</span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button-group&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;button&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:url</span>=<span class="string">&quot;`/pagesOrder/create/create?orderId=$&#123;query.id&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              再次购买</span><br><span class="line">            <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 待发货状态：模拟发货,开发期间使用,用于修改订单状态为已发货 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-if</span>=<span class="string">&quot;isDev &amp;&amp; order.orderState === OrderState.DaiFaHuo&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;button&quot;</span></span></span><br><span class="line"><span class="tag">              @<span class="attr">tap</span>=<span class="string">&quot;onOrderSend&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              模拟发货</span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-if</span>=<span class="string">&quot;order.orderState === OrderState.DaiShouHuo&quot;</span></span></span><br><span class="line"><span class="tag">              @<span class="attr">tap</span>=<span class="string">&quot;onOrderConfirm&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;button&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              确认收货</span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 配送状态 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;shipment&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- #4 订单物流信息 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">v-for</span>=<span class="string">&quot;item in logisticList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;message&quot;</span>&gt;</span></span><br><span class="line">            &#123;&#123; item.text &#125;&#125;</span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;date&quot;</span>&gt;</span> &#123;&#123; item.time &#125;&#125; <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 用户收货地址 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;locate&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">            &#123;&#123; order.receiverContact &#125;&#125; &#123;&#123; order.receiverMobile &#125;&#125;</span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;address&quot;</span>&gt;</span> &#123;&#123; order.receiverAddress &#125;&#125; <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- 商品信息 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;goods&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- #4 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;navigator&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-for</span>=<span class="string">&quot;item in order.skus&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:url</span>=<span class="string">&quot;`/pages/goods/goods?id=$&#123;item.spuId&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">image</span> <span class="attr">class</span>=<span class="string">&quot;cover&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;item.image&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;meta&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;name ellipsis&quot;</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;type&quot;</span>&gt;</span>&#123;&#123; item.attrsText &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;price&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;actual&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;symbol&quot;</span>&gt;</span>¥<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">text</span>&gt;</span>&#123;&#123; item.curPrice &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;quantity&quot;</span>&gt;</span>x&#123;&#123; item.quantity &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- #5 待评价状态:展示按钮 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;action&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-if</span>=<span class="string">&quot;order.orderState === OrderState.DaiPingJia&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span>&gt;</span>申请售后<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">navigator</span> <span class="attr">url</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span>&gt;</span> 去评价 <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- #6 合计 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;total&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>商品总价: <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;symbol&quot;</span>&gt;</span>&#123;&#123; order.totalMoney &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>运费: <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;symbol&quot;</span>&gt;</span>&#123;&#123; order.postFee &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>应付金额: <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;symbol primary&quot;</span>&gt;</span>&#123;&#123; order.payMoney &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- #7 订单信息 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;detail&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>订单信息<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;row&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">            订单编号: &#123;&#123; query.id &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;copy&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;onCopy(query.id)&quot;</span>&gt;</span>复制<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span>&gt;</span>下单时间: &#123;&#123; order.createTime &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- 猜你喜欢 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">XtxGuess</span> <span class="attr">ref</span>=<span class="string">&quot;guessRef&quot;</span> /&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 底部操作栏 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;toolbar-height&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;toolbar&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- #8 待付款状态:展示支付按钮 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;order.orderState === OrderState.DaiFuKuan&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;onOrderPay&quot;</span>&gt;</span> 去支付 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;popup?.open?.()&quot;</span>&gt;</span> 取消订单 <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 其他订单状态:按需展示按钮 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;button secondary&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:url</span>=<span class="string">&quot;`/pagesOrder/create/create?orderId=$&#123;query.id&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            再次购买</span><br><span class="line">          <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- #9 待收货状态: 展示确认收货 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-if</span>=<span class="string">&quot;order.orderState === OrderState.DaiShouHuo&quot;</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">tap</span>=<span class="string">&quot;onOrderConfirm&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            确认收货</span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- #10 待评价状态: 展示去评价 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;button&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-if</span>=<span class="string">&quot;order.orderState === OrderState.DaiPingJia&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            去评价</span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- #11 待评价/已完成/已取消 状态: 展示删除订单 --&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 待评价之后都展示 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;button delete&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-if</span>=<span class="string">&quot;order.orderState &gt;= OrderState.DaiPingJia&quot;</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">tap</span>=<span class="string">&quot;onOrderDelete&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            删除订单</span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 骨架屏组件 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">PageSkeleton</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 取消订单弹窗 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">uni-popup</span> <span class="attr">ref</span>=<span class="string">&quot;popup&quot;</span> <span class="attr">type</span>=<span class="string">&quot;bottom&quot;</span> <span class="attr">background-color</span>=<span class="string">&quot;#fff&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;popup-root&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;title&quot;</span>&gt;</span>订单取消<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;description&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tips&quot;</span>&gt;</span>请选择取消订单的原因：<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;cell&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-for</span>=<span class="string">&quot;item in reasonList&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:key</span>=<span class="string">&quot;item&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">tap</span>=<span class="string">&quot;reason = item&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;text&quot;</span>&gt;</span>&#123;&#123; item &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">:class</span>=<span class="string">&quot;&#123; checked: item === reason &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;footer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;popup?.close?.()&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span>&gt;</span>确认<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">uni-popup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-17"><a href="#小结一下-17" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-10_15-33-25.png"/>

<h2 id="再次购买"><a href="#再次购买" class="headerlink" title="再次购买"></a>再次购买</h2><p>现在是第三种生成订单信息，从订单详情页的【再次购买】按钮跳转到填写订单页，需要传递页面参数。</p>
<ol>
<li>订单详情页，<code>pagesOrder/detail/detail.vue</code>。</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;button&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:url</span>=<span class="string">&quot;`/pagesOrder/create/create?orderId=$&#123;query.id&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    再次购买</span><br><span class="line">  <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>封装接口，<code>services/order.ts</code>。</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 填写订单-再次购买</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>id 订单id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getMemberOrderRepurchaseByIdAPI = <span class="function">(<span class="params">id: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;OrderPreResult&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order/repurchase/<span class="subst">$&#123;id&#125;</span>`</span>,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="3">
<li>填写订单页，<code>pagesOrder/create/create.vue</code>。</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 页面参数</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> query = defineProps&lt;&#123;</span></span><br><span class="line"><span class="javascript">  skuId?: string</span></span><br><span class="line"><span class="javascript">  count?: string</span></span><br><span class="line"><span class="javascript">  <span class="comment">// #1</span></span></span><br><span class="line"><span class="javascript">  orderId?: string</span></span><br><span class="line"><span class="javascript">&#125;&gt;()</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取订单信息</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> orderPre = ref&lt;OrderPreResult&gt;()</span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> getMemberOrderPreData = <span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">if</span> (query.count &amp;&amp; query.skuId) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 立即购买</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> res = <span class="keyword">await</span> getMemberOrderPreNowAPI(&#123;</span></span><br><span class="line"><span class="javascript">      <span class="attr">count</span>: query.count,</span></span><br><span class="line"><span class="javascript">      <span class="attr">skuId</span>: query.skuId,</span></span><br><span class="line"><span class="javascript">    &#125;)</span></span><br><span class="line"><span class="javascript">    orderPre.value = res.result</span></span><br><span class="line"><span class="javascript">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (query.orderId) &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// #2 再次购买</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> res = <span class="keyword">await</span> getMemberOrderRepurchaseByIdAPI(query.orderId)</span></span><br><span class="line"><span class="javascript">    orderPre.value = res.result</span></span><br><span class="line"><span class="javascript">  &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 预付订单</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">const</span> res = <span class="keyword">await</span> getMemberOrderPreAPI()</span></span><br><span class="line"><span class="javascript">    orderPre.value = res.result</span></span><br><span class="line"><span class="javascript">  &#125;</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="取消订单"><a href="#取消订单" class="headerlink" title="取消订单"></a>取消订单</h2><p>仅在订单状态为<strong>待付款</strong>时，可取消订单。</p>
<ol>
<li>接口封装，<code>services/order.ts</code>。</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 取消订单</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description </span>仅在订单状态为待付款时，可取消订单。</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>id 订单id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>data cancelReason 取消理由</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getMemberOrderCancelByIdAPI = <span class="function">(<span class="params">id: <span class="built_in">string</span>, data: &#123; cancelReason: <span class="built_in">string</span> &#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;OrderResult&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;PUT&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order/<span class="subst">$&#123;id&#125;</span>/cancel`</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>绑定点击事件，<code>pagesOrder/detail/detail.vue</code>。</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;footer&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;popup?.close?.()&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;onOrderCancel&quot;</span>&gt;</span>确认<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li>代码逻辑。</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> onOrderCancel = <span class="keyword">async</span> () =&gt; &#123;</span><br><span class="line">  <span class="comment">// 发送请求</span></span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> getMemberOrderCancelByIdAPI(query.id, &#123;</span><br><span class="line">    <span class="attr">cancelReason</span>: reason.value</span><br><span class="line">  &#125;)</span><br><span class="line">  <span class="comment">// 更新订单信息</span></span><br><span class="line">  order.value = res.result</span><br><span class="line">  <span class="comment">// 关闭弹窗</span></span><br><span class="line">  popup.value?.close!()</span><br><span class="line">  <span class="comment">// 轻提示</span></span><br><span class="line">  uni.showToast(&#123; <span class="attr">icon</span>: <span class="string">&#x27;none&#x27;</span>, <span class="attr">title</span>: <span class="string">&#x27;订单取消成功&#x27;</span> &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="订单列表页"><a href="#订单列表页" class="headerlink" title="订单列表页"></a>订单列表页</h2><p>根据订单的不同状态展示订单列表，并实现多 Tabs 分页加载。</p>
<p><img src="/resource/images/order_picture_3.png" alt="订单列表"></p>
<h3 id="静态结构-3"><a href="#静态结构-3" class="headerlink" title="静态结构"></a>静态结构</h3><p><code>pagesOrder/list/list.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取屏幕边界到安全区域距离</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span></span><br><span class="line"><span class="javascript"><span class="comment">// tabs 数据</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> orderTabs = ref([</span></span><br><span class="line"><span class="javascript">  &#123; <span class="attr">orderState</span>: <span class="number">0</span>, <span class="attr">title</span>: <span class="string">&#x27;全部&#x27;</span> &#125;,</span></span><br><span class="line"><span class="javascript">  &#123; <span class="attr">orderState</span>: <span class="number">1</span>, <span class="attr">title</span>: <span class="string">&#x27;待付款&#x27;</span> &#125;,</span></span><br><span class="line"><span class="javascript">  &#123; <span class="attr">orderState</span>: <span class="number">2</span>, <span class="attr">title</span>: <span class="string">&#x27;待发货&#x27;</span> &#125;,</span></span><br><span class="line"><span class="javascript">  &#123; <span class="attr">orderState</span>: <span class="number">3</span>, <span class="attr">title</span>: <span class="string">&#x27;待收货&#x27;</span> &#125;,</span></span><br><span class="line"><span class="javascript">  &#123; <span class="attr">orderState</span>: <span class="number">4</span>, <span class="attr">title</span>: <span class="string">&#x27;待评价&#x27;</span> &#125;,</span></span><br><span class="line"><span class="javascript">])</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;viewport&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- tabs --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tabs&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;item&quot;</span> <span class="attr">v-for</span>=<span class="string">&quot;item in 5&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item&quot;</span>&gt;</span> 待付款 <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 游标 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cursor&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; left: 0 * 20 + &#x27;%&#x27; &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 滑动容器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">swiper</span> <span class="attr">class</span>=<span class="string">&quot;swiper&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 滑动项 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">swiper-item</span> <span class="attr">v-for</span>=<span class="string">&quot;item in 5&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 订单列表 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">scroll-y</span> <span class="attr">class</span>=<span class="string">&quot;orders&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;card&quot;</span> <span class="attr">v-for</span>=<span class="string">&quot;item in 2&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 订单信息 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;status&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;date&quot;</span>&gt;</span>2023-04-14 13:14:20<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">              <span class="comment">&lt;!-- 订单状态文字 --&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">text</span>&gt;</span>待付款<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">              <span class="comment">&lt;!-- 待评价/已完成/已取消 状态: 展示删除订单 --&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;icon-delete&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 商品信息，点击商品跳转到订单详情，不是商品详情 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-for</span>=<span class="string">&quot;sku in 2&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:key</span>=<span class="string">&quot;sku&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">class</span>=<span class="string">&quot;goods&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:url</span>=<span class="string">&quot;`/pagesOrder/detail/detail?id=1`&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cover&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">image</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">mode</span>=<span class="string">&quot;aspectFit&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">src</span>=<span class="string">&quot;https://yanxuan-item.nosdn.127.net/c07edde1047fa1bd0b795bed136c2bb2.jpg&quot;</span></span></span><br><span class="line"><span class="tag">                &gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;meta&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;name ellipsis&quot;</span>&gt;</span>ins风小碎花泡泡袖衬110-160cm<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;type&quot;</span>&gt;</span>藏青小花 130<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 支付信息 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;payment&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;quantity&quot;</span>&gt;</span>共5件商品<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">text</span>&gt;</span>实付<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;amount&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;symbol&quot;</span>&gt;</span>¥<span class="tag">&lt;/<span class="name">text</span>&gt;</span>99<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- 订单操作按钮 --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;action&quot;</span>&gt;</span></span><br><span class="line">              <span class="comment">&lt;!-- 待付款状态：显示去支付按钮 --&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span>&gt;</span>去支付<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;button secondary&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">:url</span>=<span class="string">&quot;`/pagesOrder/create/create?orderId=id`&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">                &gt;</span></span><br><span class="line">                  再次购买</span><br><span class="line">                <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- 待收货状态: 展示确认收货 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">view</span> <span class="attr">v-if</span>=<span class="string">&quot;false&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span>&gt;</span>确认收货<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 底部提示文字 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;loading-text&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;</span>&gt;</span></span><br><span class="line">            &#123;&#123; true ? &#x27;没有更多数据~&#x27; : &#x27;正在加载...&#x27; &#125;&#125;</span><br><span class="line">          <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">page &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css"><span class="selector-class">.viewport</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">// tabs</span></span><br><span class="line"><span class="css"><span class="selector-class">.tabs</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="attribute">justify-content</span>: space-around;</span></span><br><span class="line"><span class="css">  <span class="attribute">line-height</span>: <span class="number">60</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">4</span>rpx <span class="number">6</span>rpx <span class="built_in">rgba</span>(<span class="number">240</span>, <span class="number">240</span>, <span class="number">240</span>, <span class="number">0.6</span>);</span></span><br><span class="line"><span class="css">  <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">  <span class="attribute">z-index</span>: <span class="number">9</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.item</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#262626</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.cursor</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">    <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">20%</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">6</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">50</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">    <span class="comment">/* 过渡效果 */</span></span></span><br><span class="line"><span class="css">    <span class="attribute">transition</span>: all <span class="number">0.4s</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">// swiper</span></span><br><span class="line"><span class="css"><span class="selector-class">.swiper</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: <span class="number">#f7f7f8</span>;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">// 订单列表</span></span><br><span class="line"><span class="css"><span class="selector-class">.orders</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="selector-class">.card</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">min-height</span>: <span class="number">100</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin</span>: <span class="number">20</span>rpx <span class="number">20</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">border-radius</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">background-color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    &amp;<span class="selector-pseudo">:last-child</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding-bottom</span>: <span class="number">40</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.status</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#999</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-bottom</span>: <span class="number">15</span>rpx;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.date</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#666</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.primary</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#ff9240</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.icon-delete</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">line-height</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-left</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding-left</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-left</span>: <span class="number">1</span>rpx solid <span class="number">#e3e3e3</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.goods</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-bottom</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.cover</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">width</span>: <span class="number">170</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">170</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-right</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="css">      <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.quantity</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="css">      <span class="attribute">bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">line-height</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding</span>: <span class="number">6</span>rpx <span class="number">4</span>rpx <span class="number">6</span>rpx <span class="number">8</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">10</span>rpx <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.6</span>);</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.meta</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="css">      <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.name</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">80</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.type</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">line-height</span>: <span class="number">1.8</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">15</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-top</span>: <span class="number">10</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-self</span>: flex-start;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">4</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#888</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">background-color</span>: <span class="number">#f7f7f8</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.more</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">22</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#333</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.payment</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">justify-content</span>: flex-end;</span></span><br><span class="line"><span class="css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">line-height</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">20</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-align</span>: right;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#999</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">border-bottom</span>: <span class="number">1</span>rpx solid <span class="number">#eee</span>;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.quantity</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">24</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-right</span>: <span class="number">16</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.amount</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-left</span>: <span class="number">6</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.symbol</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.action</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">    <span class="attribute">justify-content</span>: flex-end;</span></span><br><span class="line"><span class="css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding-top</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.button</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">width</span>: <span class="number">180</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">height</span>: <span class="number">60</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">      <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="css">      <span class="attribute">margin-left</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-radius</span>: <span class="number">60</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">border</span>: <span class="number">1</span>rpx solid <span class="number">#ccc</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">font-size</span>: <span class="number">26</span>rpx;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#444</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.secondary</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">border-color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">    <span class="selector-class">.primary</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="attribute">color</span>: <span class="number">#fff</span>;</span></span><br><span class="line"><span class="css">      <span class="attribute">background-color</span>: <span class="number">#27ba9b</span>;</span></span><br><span class="line"><span class="css">    &#125;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css"></span></span><br><span class="line"><span class="css">  <span class="selector-class">.loading-text</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">color</span>: <span class="number">#666</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding</span>: <span class="number">20</span>rpx <span class="number">0</span>;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Tabs-滑动切换"><a href="#Tabs-滑动切换" class="headerlink" title="Tabs 滑动切换"></a>Tabs 滑动切换</h3><p>订单列表的 Tabs 支持滑动切换，从【我的】进入订单列表，能高亮对应的下标。</p>
<ol>
<li>循环标题和对应的轮播，点击高亮并滑动对应的轮播图，<code>pagesOder/list/list.vue</code>。</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> activeIndex = ref(<span class="number">0</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tabs&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- #1 循环标题 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- #3 点击高亮标题，@tap=&quot;activeIndex = index&quot; --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">text</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;item&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-for</span>=<span class="string">&quot;(item, index) in orderTabs&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:key</span>=<span class="string">&quot;item.title&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">tap</span>=<span class="string">&quot;activeIndex = index&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    &#123;&#123; item.title &#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- #4 控制游标 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cursor&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; left: activeIndex * 20 + &#x27;%&#x27; &#125;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- #2 循环轮播 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">swiper-item</span> <span class="attr">v-for</span>=<span class="string">&quot;item in orderTabs&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.title&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- #5 滑到对应的轮播 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">swiper</span> <span class="attr">:current</span>=<span class="string">&quot;activeIndex&quot;</span> <span class="attr">class</span>=<span class="string">&quot;swiper&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>滑动轮播图也高亮对应的 Tab。</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">swiper</span> <span class="attr">:current</span>=<span class="string">&quot;activeIndex&quot;</span> <span class="attr">class</span>=<span class="string">&quot;swiper&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;activeIndex = $event.detail.current&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure>


<h3 id="小结一下-18"><a href="#小结一下-18" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-10_15-49-53.png"/>

<h3 id="跳转-Tab-页面高亮"><a href="#跳转-Tab-页面高亮" class="headerlink" title="跳转 Tab 页面高亮"></a>跳转 Tab 页面高亮</h3><p>从【我的】页面跳过来高亮对应的 Tab。</p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// #1</span></span><br><span class="line"><span class="keyword">const</span> query = defineProps&lt;&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="built_in">string</span></span><br><span class="line">&#125;&gt;()</span><br><span class="line"></span><br><span class="line"><span class="comment">// #2</span></span><br><span class="line"><span class="comment">// 当直接点击【我的】，query.type 是 null，+null 的结果是 0</span></span><br><span class="line"><span class="keyword">const</span> activeIndex = ref(</span><br><span class="line">  orderTabs.value.findIndex(<span class="function">(<span class="params">v</span>) =&gt;</span> v.orderState === +query.type)</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p><code>pagesOrder/list/list.vue</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> query = defineProps&lt;&#123;</span><br><span class="line">  <span class="attr">type</span>: <span class="built_in">string</span></span><br><span class="line">&#125;&gt;()</span><br><span class="line"><span class="keyword">const</span> activeIndex = ref(orderTabs.value.findIndex(<span class="function"><span class="params">v</span> =&gt;</span> v.orderState === <span class="built_in">Number</span>(query.type)))</span><br></pre></td></tr></table></figure>

<img src="/resource/images/Snipaste_2023-05-10_15-55-43.png"/>

<h3 id="获取订单列表"><a href="#获取订单列表" class="headerlink" title="获取订单列表"></a>获取订单列表</h3><p>当前页面是<strong>多 Tabs 列表</strong>的情况，每个 Tabs 都是独立的列表，并支持分页加载。</p>
<ol>
<li>定义类型，<code>types/order.d.ts</code>。</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; PageParams &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/global&#x27;</span></span><br><span class="line"><span class="comment">/** 订单列表参数 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> OrderListParams = PageParams &amp; &#123; <span class="attr">orderState</span>: <span class="built_in">number</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 订单列表 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> OrderListResult = &#123;</span><br><span class="line">  <span class="comment">/** 总记录数 */</span></span><br><span class="line">  <span class="attr">counts</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 数据集合    [ 订单信息 ] */</span></span><br><span class="line">  <span class="attr">items</span>: OrderItem[]</span><br><span class="line">  <span class="comment">/** 当前页码 */</span></span><br><span class="line">  <span class="attr">page</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 总页数 */</span></span><br><span class="line">  <span class="attr">pages</span>: <span class="built_in">number</span></span><br><span class="line">  <span class="comment">/** 页尺寸 */</span></span><br><span class="line">  <span class="attr">pageSize</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** 订单列表项 */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">type</span> OrderItem = OrderResult &amp; &#123;</span><br><span class="line">  <span class="comment">/** 总件数 */</span></span><br><span class="line">  <span class="attr">totalNum</span>: <span class="built_in">number</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li>接口封装，<code>services/order.ts</code>。</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="keyword">type</span> &#123; OrderListParams, OrderListResult &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/order&#x27;</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 获取订单列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param </span>data orderState 订单状态</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getMemberOrderAPI = <span class="function">(<span class="params">data: OrderListParams</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> http&lt;OrderListResult&gt;(&#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">    <span class="attr">url</span>: <span class="string">`/member/order`</span>,</span><br><span class="line">    data,</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="订单列表渲染"><a href="#订单列表渲染" class="headerlink" title="订单列表渲染"></a>订单列表渲染</h3><p>为了更好维护<strong>多 Tabs 列表</strong>，把列表抽离成业务组件，在组件内部独立维护列表数据，包括分页，下拉刷新等业务。</p>
<ol>
<li>封装列表组件，<code>pagesOrder/list/components/OrderList.vue</code>。</li>
</ol>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; OrderState &#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/constants&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; orderStateList &#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/constants&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; getMemberOrderAPI &#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/order&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> type &#123; OrderItem &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/order&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> type &#123; OrderListParams &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/order&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取屏幕边界到安全区域距离</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> &#123; safeAreaInsets &#125; = uni.getSystemInfoSync()</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 定义 porps</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> props = defineProps&lt;&#123;</span></span><br><span class="line"><span class="javascript">  <span class="attr">orderState</span>: number</span></span><br><span class="line"><span class="javascript">&#125;&gt;()</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 请求参数</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> queryParams: OrderListParams = &#123;</span></span><br><span class="line"><span class="javascript">  <span class="attr">page</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="javascript">  <span class="attr">pageSize</span>: <span class="number">5</span>,</span></span><br><span class="line"><span class="javascript">  <span class="attr">orderState</span>: props.orderState,</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 获取订单列表</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> orderList = ref&lt;OrderItem[]&gt;([])</span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> getMemberOrderData = <span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> res = <span class="keyword">await</span> getMemberOrderAPI(queryParams)</span></span><br><span class="line"><span class="javascript">  orderList.value = res.result.items</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"><span class="comment">// 组件</span></span></span><br><span class="line"><span class="javascript">onMounted(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  getMemberOrderData()</span></span><br><span class="line"><span class="javascript">&#125;)</span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">scroll-view</span> <span class="attr">scroll-y</span> <span class="attr">class</span>=<span class="string">&quot;orders&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;card&quot;</span> <span class="attr">v-for</span>=<span class="string">&quot;order in orderList&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;order.id&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 订单信息 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;status&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;date&quot;</span>&gt;</span>&#123;&#123; order.createTime &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 订单状态文字 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span>&gt;</span>&#123;&#123; orderStateList[order.orderState].text &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 待评价/已完成/已取消 状态: 展示删除订单 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">v-if</span>=<span class="string">&quot;order.orderState &gt;= OrderState.DaiPingJia&quot;</span> <span class="attr">class</span>=<span class="string">&quot;icon-delete&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 商品信息，点击商品跳转到订单详情，不是商品详情 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-for</span>=<span class="string">&quot;item in order.skus&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;goods&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:url</span>=<span class="string">&quot;`/pagesOrder/detail/detail?id=$&#123;order.id&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;cover&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">image</span> <span class="attr">mode</span>=<span class="string">&quot;aspectFit&quot;</span> <span class="attr">:src</span>=<span class="string">&quot;item.image&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;meta&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;name ellipsis&quot;</span>&gt;</span>&#123;&#123; item.name &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;type&quot;</span>&gt;</span>&#123;&#123; item.attrsText &#125;&#125;<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 支付信息 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;payment&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;quantity&quot;</span>&gt;</span>共&#123;&#123; order.totalNum &#125;&#125;件商品<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span>&gt;</span>实付<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;amount&quot;</span>&gt;</span> <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;symbol&quot;</span>&gt;</span>¥<span class="tag">&lt;/<span class="name">text</span>&gt;</span>&#123;&#123; order.payMoney &#125;&#125;<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 订单操作按钮 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;action&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 待付款状态：显示去支付按钮 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">&quot;order.orderState === OrderState.DaiFuKuan&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span>&gt;</span>去支付<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-else</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;button secondary&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:url</span>=<span class="string">&quot;`/pagesOrder/create/create?orderId=id`&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            再次购买</span><br><span class="line">          <span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 待收货状态: 展示确认收货 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">view</span> <span class="attr">v-if</span>=<span class="string">&quot;order.orderState === OrderState.DaiShouHuo&quot;</span> <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span>确认收货&lt;/view</span><br><span class="line">          &gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 底部提示文字 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;loading-text&quot;</span> <span class="attr">:style</span>=<span class="string">&quot;&#123; paddingBottom: safeAreaInsets?.bottom + &#x27;px&#x27; &#125;&quot;</span>&gt;</span></span><br><span class="line">      &#123;&#123; true ? &#x27;没有更多数据~&#x27; : &#x27;正在加载...&#x27; &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">scroll-view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li>订单列表页，把订单状态传递给列表组件（父传子），<code>pagesOrder/list/list.vue</code>。</li>
</ol>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> OrderList <span class="keyword">from</span> <span class="string">&#x27;./components/OrderList.vue&#x27;</span></span><br><span class="line"><span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">swiper</span> <span class="attr">class</span>=<span class="string">&quot;swiper&quot;</span> <span class="attr">:current</span>=<span class="string">&quot;activeIndex&quot;</span> @<span class="attr">change</span>=<span class="string">&quot;activeIndex = $event.detail.current&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 滑动项 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">swiper-item</span> <span class="attr">v-for</span>=<span class="string">&quot;item in orderTabs&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;item.title&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 订单列表 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">OrderList</span> <span class="attr">:order-state</span>=<span class="string">&quot;item.orderState&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">swiper-item</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">swiper</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="小结一下-19"><a href="#小结一下-19" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-10_16-09-57.png"/>

<h3 id="分页加载"><a href="#分页加载" class="headerlink" title="分页加载"></a>分页加载</h3><p>分页加载的逻辑在之前我们已经学习过，本节就不再重复讲义的内容了，下拉刷新业务同理。</p>
<h3 id="订单支付-1"><a href="#订单支付-1" class="headerlink" title="订单支付"></a>订单支付</h3><p>订单支付功能之前我们已经学习过，也不再重复，确认收货，删除订单等按钮的业务同理。</p>
<p><code>pagesOrder/list/components/OrderList.vue</code></p>
<figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> onOrderPay = <span class="keyword">async</span> (id: <span class="built_in">string</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">import</span>.meta.env.DEV) &#123;</span><br><span class="line">    <span class="keyword">await</span> getPayMockAPI(&#123; <span class="attr">orderId</span>: id &#125;)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> res = <span class="keyword">await</span> getPayWxPayMiniPayAPI(&#123; <span class="attr">orderId</span>: id &#125;)</span><br><span class="line">    wx.requestPayment(res.result)</span><br><span class="line">  &#125;</span><br><span class="line">  uni.showToast(&#123; <span class="attr">title</span>: <span class="string">&#x27;支付成功&#x27;</span> &#125;)</span><br><span class="line">  <span class="keyword">const</span> order = orderList.value.find(<span class="function"><span class="params">v</span> =&gt;</span> v.id === id)</span><br><span class="line">  order!.orderState = OrderState.DaiFaHuo</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;button primary&quot;</span> @<span class="attr">tap</span>=<span class="string">&quot;onOrderPay(order.id)&quot;</span>&gt;</span>去支付<span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">navigator</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;button secondary&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:url</span>=<span class="string">&quot;`/pagesOrder/create/create?orderId=$&#123;order.id&#125;`&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">hover-class</span>=<span class="string">&quot;none&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  再次购买</span><br><span class="line"><span class="tag">&lt;/<span class="name">navigator</span>&gt;</span></span><br></pre></td></tr></table></figure>

<img src="/resource/images/Snipaste_2023-05-10_16-23-54.png"/>

<h2 id="微信小程序端"><a href="#微信小程序端" class="headerlink" title="微信小程序端"></a>微信小程序端</h2><p>把当前 uni-app 项目打包成微信小程序端，并发布上线。</p>
<h3 id="核心步骤"><a href="#核心步骤" class="headerlink" title="核心步骤"></a>核心步骤</h3><ol>
<li><p>运行打包命令 <code>pnpm build:mp-weixin</code>。</p>
</li>
<li><p>预览和测试，微信开发者工具导入生成的 <code>/dist/build/mp-weixin</code> 目录。</p>
</li>
<li><p>上传小程序代码。</p>
</li>
<li><p>提交审核和发布。</p>
</li>
</ol>
<h3 id="步骤图示"><a href="#步骤图示" class="headerlink" title="步骤图示"></a>步骤图示</h3><p>项目打包上线需要使用到多个工具，注意工具之间的职责。</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">VSCode ----&gt; 微信开发者工具 ----&gt; 微信公众平台</span><br></pre></td></tr></table></figure>

<p>了解：开发者可独立使用 <a target="_blank" rel="noopener" href="https://developers.weixin.qq.com/miniprogram/dev/devtools/ci.html">miniprogram-ci</a> 进行小程序代码的上传等操作!</p>
<p>打包成其他小程序端的步骤类似，只是更换了 <strong>打包命令</strong> 和 <strong>开发者工具</strong>。</p>
<h3 id="小结一下-20"><a href="#小结一下-20" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-10_16-38-46.png"/>

<h2 id="条件编译"><a href="#条件编译" class="headerlink" title="条件编译"></a>条件编译</h2><h3 id="基本了解"><a href="#基本了解" class="headerlink" title="基本了解"></a>基本了解</h3><p>Q：按照 uni-app 规范开发可保证多平台兼容，但每个平台有自己的一些特性，该如何处理？</p>
<p>A：通过<a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/tutorial/platform.html#preprocessor">条件编译</a>，让代码按条件编译到指定平台。</p>
<p><img src="/resource/images/build_picture_2.png" alt="多端登录"></p>
<p><strong>网页端不支持微信平台授权登录等功能</strong>，可通过 <a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/tutorial/platform.html#preprocessor">条件编译</a>，实现不同端渲染不同的登录界面。</p>
<h3 id="条件编译语法"><a href="#条件编译语法" class="headerlink" title="条件编译语法"></a>条件编译语法</h3><p>通过特殊注释，以 <code>#ifdef</code> 或 <code>#ifndef</code> 加 平台名称 开头，以 <code>#endif</code> 结尾，支持 vue、ts、js、scss、css、<code>pages.json</code> 等文件。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// 微信平台特有 API，需要条件编译</span></span></span><br><span class="line"><span class="javascript"><span class="comment">// #ifdef MP-WEIXIN</span></span></span><br><span class="line"><span class="javascript">wx.login()</span></span><br><span class="line"><span class="javascript">wx.requestPayment()</span></span><br><span class="line"><span class="javascript"><span class="comment">// #endif</span></span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 微信开发能力按钮，需要条件编译 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- #ifdef MP-WEIXIN --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">open-type</span>=<span class="string">&quot;openSetting&quot;</span>&gt;</span>授权管理<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">open-type</span>=<span class="string">&quot;feedback&quot;</span>&gt;</span>问题反馈<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">open-type</span>=<span class="string">&quot;contact&quot;</span>&gt;</span>联系我们<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- #endif --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css"><span class="comment">/* 如果出现样式兼容，也可添加条件编译 */</span></span></span><br><span class="line"><span class="css">page &#123;</span></span><br><span class="line"><span class="css">  <span class="comment">/* #ifdef H5 */</span></span></span><br><span class="line"><span class="css">  <span class="attribute">background-color</span>: pink;</span></span><br><span class="line"><span class="css">  <span class="comment">/* #endif */</span></span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>了解：<code>#ifdef H5 || MP-WEIXIN</code> 表示在 H5 平台 <strong>或</strong> 微信小程序平台存在的代码。</p>
<p>可通过搜索 <code>wx.</code> 和 <code>open-type</code> 等平台关键词，快速查找需要添加编译模式的代码。</p>
<h3 id="操作代码"><a href="#操作代码" class="headerlink" title="操作代码"></a>操作代码</h3><p><code>pnpm dev:h5</code></p>
<p><code>pages/login/login.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; onLoad &#125; <span class="keyword">from</span> <span class="string">&#x27;@dcloudio/uni-app&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; postLoginWxMinAPI, postLoginWxMinSimpleAPI &#125; <span class="keyword">from</span> <span class="string">&#x27;@/services/login&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> type &#123; LoginResult &#125; <span class="keyword">from</span> <span class="string">&#x27;@/types/member&#x27;</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">import</span> &#123; useMemberStore &#125; <span class="keyword">from</span> <span class="string">&#x27;@/stores&#x27;</span></span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="comment">// #4</span></span></span><br><span class="line"><span class="javascript"><span class="comment">// #ifdef MP-WEIXIN</span></span></span><br><span class="line"><span class="javascript"><span class="keyword">let</span> code = <span class="string">&#x27;&#x27;</span></span></span><br><span class="line"><span class="javascript">onLoad(<span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> res = <span class="keyword">await</span> uni.login()</span></span><br><span class="line"><span class="javascript">  code = res.code</span></span><br><span class="line"><span class="javascript">&#125;)</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> loginSuccess = <span class="function">(<span class="params">profile: LoginResult</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 保存会员信息</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> memberStore = useMemberStore()</span></span><br><span class="line"><span class="javascript">  memberStore.setProfile(profile)</span></span><br><span class="line"><span class="javascript">  <span class="comment">// 成功提示</span></span></span><br><span class="line"><span class="javascript">  uni.showToast(&#123; <span class="attr">icon</span>: <span class="string">&#x27;success&#x27;</span>, <span class="attr">title</span>: <span class="string">&#x27;登录成功&#x27;</span> &#125;)</span></span><br><span class="line"><span class="javascript">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="javascript">    <span class="comment">// 页面跳转</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">// uni.switchTab(&#123; url: &#x27;/pages/my/my&#x27; &#125;)</span></span></span><br><span class="line"><span class="javascript">    uni.navigateBack()</span></span><br><span class="line"><span class="javascript">  &#125;, <span class="number">500</span>)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onGetphonenumber: UniHelper.ButtonOnGetphonenumber = <span class="keyword">async</span> (ev) =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> encryptedData = ev.detail.encryptedData!</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> iv = ev.detail.iv!</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> res = <span class="keyword">await</span> postLoginWxMinAPI(&#123; code, encryptedData, iv &#125;)</span></span><br><span class="line"><span class="javascript">  loginSuccess(res.result)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"></span></span><br><span class="line"><span class="javascript"><span class="keyword">const</span> onGetphonenumberSimple = <span class="keyword">async</span> () =&gt; &#123;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">const</span> res = <span class="keyword">await</span> postLoginWxMinSimpleAPI(<span class="string">&#x27;13123456789&#x27;</span>)</span></span><br><span class="line"><span class="javascript">  loginSuccess(res.result)</span></span><br><span class="line"><span class="javascript">&#125;</span></span><br><span class="line"><span class="javascript"><span class="comment">// #endif</span></span></span><br><span class="line"><span class="javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;viewport&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;logo&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">image</span></span></span><br><span class="line"><span class="tag">        <span class="attr">src</span>=<span class="string">&quot;https://pcapi-xiaotuxian-front-devtest.itheima.net/miniapp/images/logo_icon.png&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;login&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- #2 --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- #ifdef H5 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;input&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入用户名/手机号码&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">class</span>=<span class="string">&quot;input&quot;</span> <span class="attr">password</span> <span class="attr">placeholder</span>=<span class="string">&quot;请输入密码&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">&quot;button phone&quot;</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- #endif --&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="comment">&lt;!-- #1 --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- #ifdef MP-WEIXIN --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">button</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;button phone&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">open-type</span>=<span class="string">&quot;getPhoneNumber&quot;</span></span></span><br><span class="line"><span class="tag">        @<span class="attr">getphonenumber</span>=<span class="string">&quot;onGetphonenumber&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;icon icon-phone&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        手机号快捷登录</span><br><span class="line">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- #endif --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;extra&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;caption&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">text</span>&gt;</span>其他登录方式<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;options&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">text</span> <span class="attr">class</span>=<span class="string">&quot;icon icon-phone&quot;</span>&gt;</span>模拟快捷登录<span class="tag">&lt;/<span class="name">text</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">&quot;tips&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span>登录/注册即视为你同意《服务条款》和《小兔鲜儿隐私协议》&lt;/view</span><br><span class="line">      &gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">lang</span>=<span class="string">&quot;scss&quot;</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">// ...</span></span><br><span class="line"><span class="css"><span class="selector-class">.login</span> &#123;</span></span><br><span class="line"><span class="css">  <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="css">  <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="css">  <span class="attribute">height</span>: <span class="number">60vh</span>;</span></span><br><span class="line"><span class="css">  <span class="attribute">padding</span>: <span class="number">40</span>rpx <span class="number">20</span>rpx <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  <span class="comment">/* #3 */</span></span></span><br><span class="line"><span class="css">  <span class="selector-class">.input</span> &#123;</span></span><br><span class="line"><span class="css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">height</span>: <span class="number">80</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">font-size</span>: <span class="number">28</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">border-radius</span>: <span class="number">72</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ddd</span>;</span></span><br><span class="line"><span class="css">    <span class="attribute">padding-left</span>: <span class="number">30</span>rpx;</span></span><br><span class="line"><span class="css">    <span class="attribute">margin-bottom</span>: <span class="number">20</span>rpx;</span></span><br><span class="line"><span class="css">  &#125;</span></span><br><span class="line"><span class="css">  // ...  </span></span><br><span class="line"><span class="css">&#125;</span></span><br><span class="line"><span class="css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="打包为-H5-端"><a href="#打包为-H5-端" class="headerlink" title="打包为 H5 端"></a>打包为 H5 端</h2><p>把当前 uni-app 项目打包成网页(H5)端，并配置路由基础路径。</p>
<h3 id="核心步骤-1"><a href="#核心步骤-1" class="headerlink" title="核心步骤"></a>核心步骤</h3><ol>
<li><p>运行打包命令 <code>pnpm build:h5</code>。</p>
</li>
<li><p>预览和测试，使用浏览器打开 <code>/dist/build/h5</code> 目录下的 <code>index.html</code> 文件。</p>
</li>
<li><p>由运维部署到服务器。</p>
</li>
</ol>
<h3 id="路由基础路径"><a href="#路由基础路径" class="headerlink" title="路由基础路径"></a>路由基础路径</h3><p>默认的路由基础路径为 <code>/</code> 根路径，部分网站并不是部署到根路径，需要按运维要求调整，<code>manifest.json</code>。</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* 小程序特有相关 */</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">&quot;mp-weixin&quot;</span>: &#123;</span><br><span class="line">    <span class="comment">// …省略</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="comment">/* 网页端特有配置 */</span></span><br><span class="line">  <span class="attr">&quot;h5&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;router&quot;</span>: &#123;</span><br><span class="line">      <span class="comment">// 基础路径：./ 为相对路径</span></span><br><span class="line">      <span class="attr">&quot;base&quot;</span>: <span class="string">&quot;./&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="string">&quot;vueVersion&quot;</span>: <span class="string">&quot;3&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="小结一下-21"><a href="#小结一下-21" class="headerlink" title="小结一下"></a>小结一下</h3><img src="/resource/images/Snipaste_2023-05-10_16-49-58.png"/>

<h2 id="打包为-APP-端"><a href="#打包为-APP-端" class="headerlink" title="打包为 APP 端"></a>打包为 APP 端</h2><p><a target="_blank" rel="noopener" href="https://uniapp.dcloud.net.cn/tutorial/run/run-app.html">App 端</a> 的打包，预览、测试、发行，使用 <code>HBuilderX</code> 工具。</p>
<p><code>login.vue</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- #ifdef MP-WEIXIN --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- #endif --&gt;</span></span><br></pre></td></tr></table></figure>


    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2023/05/06/xcx-xtx-05/" rel="prev" title="05_小兔鲜">
      <i class="fa fa-chevron-left"></i> 05_小兔鲜
    </a></div>
      <div class="post-nav-item">
    <a href="/2023/07/23/slwl-course01/" rel="next" title="slwl-course01">
      slwl-course01 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8A%A0%E5%85%A5%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="nav-number">1.</span> <span class="nav-text">加入购物车</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E5%B0%81%E8%A3%85"><span class="nav-number">1.1.</span> <span class="nav-text">接口封装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81"><span class="nav-number">1.2.</span> <span class="nav-text">参考代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B"><span class="nav-number">1.3.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B4%AD%E7%89%A9%E8%BD%A6%E5%88%97%E8%A1%A8"><span class="nav-number">2.</span> <span class="nav-text">购物车列表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84"><span class="nav-number">2.1.</span> <span class="nav-text">静态结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%99%BB%E5%BD%95%E7%8A%B6%E6%80%81"><span class="nav-number">2.2.</span> <span class="nav-text">登录状态</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93"><span class="nav-number">2.3.</span> <span class="nav-text">列表渲染</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-1"><span class="nav-number">2.4.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="nav-number">3.</span> <span class="nav-text">删除购物车</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E5%B0%81%E8%A3%85-1"><span class="nav-number">3.1.</span> <span class="nav-text">接口封装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-1"><span class="nav-number">3.2.</span> <span class="nav-text">参考代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-2"><span class="nav-number">3.3.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E5%95%86%E5%93%81%E4%BF%A1%E6%81%AF"><span class="nav-number">4.</span> <span class="nav-text">修改商品信息</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E5%B0%81%E8%A3%85-2"><span class="nav-number">4.1.</span> <span class="nav-text">接口封装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E5%95%86%E5%93%81%E6%95%B0%E9%87%8F"><span class="nav-number">4.2.</span> <span class="nav-text">修改商品数量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-2"><span class="nav-number">4.3.</span> <span class="nav-text">参考代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-3"><span class="nav-number">4.4.</span> <span class="nav-text">小结一下</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E5%95%86%E5%93%81%E9%80%89%E4%B8%AD-%E5%85%A8%E9%80%89"><span class="nav-number">4.5.</span> <span class="nav-text">修改商品选中&#x2F;全选</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-3"><span class="nav-number">4.6.</span> <span class="nav-text">参考代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-4"><span class="nav-number">4.7.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BA%95%E9%83%A8%E7%BB%93%E7%AE%97%E4%BF%A1%E6%81%AF"><span class="nav-number">5.</span> <span class="nav-text">底部结算信息</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E6%80%BB%E9%92%B1%E6%95%B0-%E6%80%BB%E9%87%91%E9%A2%9D"><span class="nav-number">5.1.</span> <span class="nav-text">计算总钱数(总金额)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-5"><span class="nav-number">5.2.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%A6%E8%BF%94%E5%9B%9E%E6%8C%89%E9%92%AE%E7%9A%84%E8%B4%AD%E7%89%A9%E8%BD%A6"><span class="nav-number">6.</span> <span class="nav-text">带返回按钮的购物车</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%A1%AB%E5%86%99%E8%AE%A2%E5%8D%95%E9%A1%B5"><span class="nav-number">7.</span> <span class="nav-text">填写订单页</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-1"><span class="nav-number">7.1.</span> <span class="nav-text">静态结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B8%B2%E6%9F%93%E5%9F%BA%E6%9C%AC%E4%BF%A1%E6%81%AF"><span class="nav-number">7.2.</span> <span class="nav-text">渲染基本信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B8%B2%E6%9F%93%E5%86%85%E5%AE%B9"><span class="nav-number">7.3.</span> <span class="nav-text">渲染内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-6"><span class="nav-number">7.4.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B8%B2%E6%9F%93%E6%94%B6%E8%8E%B7%E5%9C%B0%E5%9D%80"><span class="nav-number">8.</span> <span class="nav-text">渲染收获地址</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%B0%E5%9D%80%E7%AE%A1%E7%90%86%E9%A1%B5"><span class="nav-number">8.1.</span> <span class="nav-text">地址管理页</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-7"><span class="nav-number">8.2.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%AB%8B%E5%8D%B3%E8%B4%AD%E4%B9%B0"><span class="nav-number">9.</span> <span class="nav-text">立即购买</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%81%E8%A3%85%E6%8E%A5%E5%8F%A3"><span class="nav-number">9.1.</span> <span class="nav-text">封装接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A1%B5%E9%9D%A2%E4%BC%A0%E5%8F%82"><span class="nav-number">9.2.</span> <span class="nav-text">页面传参</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A1%AB%E5%86%99%E8%AE%A2%E5%8D%95"><span class="nav-number">9.3.</span> <span class="nav-text">填写订单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-8"><span class="nav-number">9.4.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%90%E4%BA%A4%E8%AE%A2%E5%8D%95"><span class="nav-number">10.</span> <span class="nav-text">提交订单</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E5%A3%B0%E6%98%8E"><span class="nav-number">10.1.</span> <span class="nav-text">类型声明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E5%B0%81%E8%A3%85-3"><span class="nav-number">10.2.</span> <span class="nav-text">接口封装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-4"><span class="nav-number">10.3.</span> <span class="nav-text">参考代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-9"><span class="nav-number">10.4.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A2%E5%8D%95%E8%AF%A6%E6%83%85%E9%A1%B5"><span class="nav-number">11.</span> <span class="nav-text">订单详情页</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-2"><span class="nav-number">11.1.</span> <span class="nav-text">静态结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AF%BC%E8%88%AA%E6%A0%8F%E4%BA%A4%E4%BA%92"><span class="nav-number">11.2.</span> <span class="nav-text">自定义导航栏交互</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-10"><span class="nav-number">11.3.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E8%AE%A2%E5%8D%95%E8%AF%A6%E6%83%85"><span class="nav-number">12.</span> <span class="nav-text">获取订单详情</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B8%B2%E6%9F%93%E8%AE%A2%E5%8D%95%E7%8A%B6%E6%80%81"><span class="nav-number">13.</span> <span class="nav-text">渲染订单状态</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%86%85%E5%AE%B9"><span class="nav-number">13.1.</span> <span class="nav-text">基本内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-11"><span class="nav-number">13.2.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%94%AF%E4%BB%98%E5%80%92%E8%AE%A1%E6%97%B6"><span class="nav-number">14.</span> <span class="nav-text">支付倒计时</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-5"><span class="nav-number">14.1.</span> <span class="nav-text">参考代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-12"><span class="nav-number">14.2.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98"><span class="nav-number">15.</span> <span class="nav-text">订单支付</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E8%AF%B4%E6%98%8E"><span class="nav-number">15.1.</span> <span class="nav-text">微信支付说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E8%80%83%E4%BB%A3%E7%A0%81-6"><span class="nav-number">15.2.</span> <span class="nav-text">参考代码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%94%AF%E4%BB%98%E6%88%90%E5%8A%9F%E9%A1%B5"><span class="nav-number">15.3.</span> <span class="nav-text">支付成功页</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-13"><span class="nav-number">15.4.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A8%A1%E6%8B%9F%E5%8F%91%E8%B4%A7"><span class="nav-number">16.</span> <span class="nav-text">模拟发货</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%86%85%E5%AE%B9-1"><span class="nav-number">16.1.</span> <span class="nav-text">基本内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-14"><span class="nav-number">16.2.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A1%AE%E8%AE%A4%E6%94%B6%E8%B4%A7"><span class="nav-number">17.</span> <span class="nav-text">确认收货</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%86%85%E5%AE%B9-2"><span class="nav-number">17.1.</span> <span class="nav-text">基本内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-15"><span class="nav-number">17.2.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A2%E5%8D%95%E7%89%A9%E6%B5%81"><span class="nav-number">18.</span> <span class="nav-text">订单物流</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%B7%E6%B1%82%E5%B0%81%E8%A3%85"><span class="nav-number">18.1.</span> <span class="nav-text">请求封装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-16"><span class="nav-number">18.2.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%AE%A2%E5%8D%95"><span class="nav-number">19.</span> <span class="nav-text">删除订单</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%A5%E5%8F%A3%E5%B0%81%E8%A3%85-4"><span class="nav-number">19.1.</span> <span class="nav-text">接口封装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%B1%95%E7%A4%BA"><span class="nav-number">19.2.</span> <span class="nav-text">代码展示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-17"><span class="nav-number">19.3.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%86%8D%E6%AC%A1%E8%B4%AD%E4%B9%B0"><span class="nav-number">20.</span> <span class="nav-text">再次购买</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8F%96%E6%B6%88%E8%AE%A2%E5%8D%95"><span class="nav-number">21.</span> <span class="nav-text">取消订单</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A2%E5%8D%95%E5%88%97%E8%A1%A8%E9%A1%B5"><span class="nav-number">22.</span> <span class="nav-text">订单列表页</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%99%E6%80%81%E7%BB%93%E6%9E%84-3"><span class="nav-number">22.1.</span> <span class="nav-text">静态结构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Tabs-%E6%BB%91%E5%8A%A8%E5%88%87%E6%8D%A2"><span class="nav-number">22.2.</span> <span class="nav-text">Tabs 滑动切换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-18"><span class="nav-number">22.3.</span> <span class="nav-text">小结一下</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%B3%E8%BD%AC-Tab-%E9%A1%B5%E9%9D%A2%E9%AB%98%E4%BA%AE"><span class="nav-number">22.4.</span> <span class="nav-text">跳转 Tab 页面高亮</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E8%AE%A2%E5%8D%95%E5%88%97%E8%A1%A8"><span class="nav-number">22.5.</span> <span class="nav-text">获取订单列表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%A2%E5%8D%95%E5%88%97%E8%A1%A8%E6%B8%B2%E6%9F%93"><span class="nav-number">22.6.</span> <span class="nav-text">订单列表渲染</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-19"><span class="nav-number">22.7.</span> <span class="nav-text">小结一下</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E9%A1%B5%E5%8A%A0%E8%BD%BD"><span class="nav-number">22.8.</span> <span class="nav-text">分页加载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%A2%E5%8D%95%E6%94%AF%E4%BB%98-1"><span class="nav-number">22.9.</span> <span class="nav-text">订单支付</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E7%AB%AF"><span class="nav-number">23.</span> <span class="nav-text">微信小程序端</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E6%AD%A5%E9%AA%A4"><span class="nav-number">23.1.</span> <span class="nav-text">核心步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A5%E9%AA%A4%E5%9B%BE%E7%A4%BA"><span class="nav-number">23.2.</span> <span class="nav-text">步骤图示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-20"><span class="nav-number">23.3.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E7%BC%96%E8%AF%91"><span class="nav-number">24.</span> <span class="nav-text">条件编译</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E4%BA%86%E8%A7%A3"><span class="nav-number">24.1.</span> <span class="nav-text">基本了解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6%E7%BC%96%E8%AF%91%E8%AF%AD%E6%B3%95"><span class="nav-number">24.2.</span> <span class="nav-text">条件编译语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E4%BB%A3%E7%A0%81"><span class="nav-number">24.3.</span> <span class="nav-text">操作代码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E4%B8%BA-H5-%E7%AB%AF"><span class="nav-number">25.</span> <span class="nav-text">打包为 H5 端</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%B8%E5%BF%83%E6%AD%A5%E9%AA%A4-1"><span class="nav-number">25.1.</span> <span class="nav-text">核心步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B7%AF%E7%94%B1%E5%9F%BA%E7%A1%80%E8%B7%AF%E5%BE%84"><span class="nav-number">25.2.</span> <span class="nav-text">路由基础路径</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B0%8F%E7%BB%93%E4%B8%80%E4%B8%8B-21"><span class="nav-number">25.3.</span> <span class="nav-text">小结一下</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%89%93%E5%8C%85%E4%B8%BA-APP-%E7%AB%AF"><span class="nav-number">26.</span> <span class="nav-text">打包为 APP 端</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Ifer"
      src="/images/49337922.png">
  <p class="site-author-name" itemprop="name">Ifer</p>
  <div class="site-description" itemprop="description">React 全家桶 <span style='position:relative;top:-2px;'>✍</span></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">99</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://www.bilibili.com/video/BV1iW4y1k7Ci?spm_id_from=333.337.search-card.all.click" title="😚 → https:&#x2F;&#x2F;www.bilibili.com&#x2F;video&#x2F;BV1iW4y1k7Ci?spm_id_from&#x3D;333.337.search-card.all.click" rel="noopener" target="_blank"><i class="a fa-fw"></i>😚</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.zhihu.com/people/weixiantx" title="😙 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;weixiantx" rel="noopener" target="_blank"><i class="a fa-fw"></i>😙</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ifer</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
